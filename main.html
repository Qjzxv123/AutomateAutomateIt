<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Automate It Production Planner</title>
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
	<style>
		body {
			font-family: 'Roboto', Arial, sans-serif;
			background: #181c20;
			color: #f3f3f3;
			margin: 0;
			padding: 0;
		}
		header {
			background: #23272b;
			padding: 1.5rem 2rem;
			display: flex;
			align-items: center;
			justify-content: space-between;
			box-shadow: 0 2px 8px #000a;
		}
		.logo {
			font-size: 2rem;
			font-weight: 700;
			letter-spacing: 2px;
			color: #ffb347;
		}
		.planner-container {
			max-width: 1200px;
			margin: 2rem auto;
			background: #23272b;
			border-radius: 16px;
			box-shadow: 0 4px 24px #0006;
			padding: 2rem;
		}
		.input-section {
			display: flex;
			gap: 1rem;
			align-items: center;
			margin-bottom: 2rem;
		}
		.input-section select, .input-section input {
			padding: 0.5rem 1rem;
			border-radius: 8px;
			border: none;
			font-size: 1rem;
		}
		.input-section button {
			background: #ffb347;
			color: #23272b;
			border: none;
			border-radius: 8px;
			padding: 0.5rem 1.5rem;
			font-size: 1rem;
			font-weight: 700;
			cursor: pointer;
			transition: background 0.2s;
		}
		.input-section button:hover {
			background: #ffd580;
		}
		.production-plan {
			background: #1a1e22;
			border-radius: 12px;
			padding: 2rem;
			min-height: 300px;
			box-shadow: 0 2px 8px #0004;
		}
		.placeholder-graph {
			color: #888;
			text-align: center;
			margin-top: 4rem;
			font-size: 1.2rem;
		}
	</style>
</head>
<body>
	<header>
		<div class="logo">Automate It Planner</div>
		<div>Inspired by satisfactory-calculator.com</div>
	</header>
	<div class="planner-container">
		<div class="input-section">
			<!-- Custom select with icons. The real value is stored in the hidden input (#item-select) for compatibility -->
			<div id="item-select-container" style="position:relative;display:inline-block;">
				<input type="hidden" id="item-select" value="">
				<button type="button" id="item-select-toggle" style="background:#2b2f33;color:#fff;border:none;padding:0.4rem 0.6rem;border-radius:8px;display:inline-flex;align-items:center;gap:0.5rem;cursor:pointer;">
					<img id="item-select-icon" src="" alt="" style="width:24px;height:24px;display:none;object-fit:contain;border-radius:4px;">
					<span id="item-select-label">Select Item</span>
					<span style="margin-left:8px;font-size:0.9rem;opacity:0.8;">â–¾</span>
				</button>
				<div id="item-select-options" style="display:none;position:absolute;left:0;top:calc(100% + 6px);background:#23272b;border:1px solid #333;border-radius:8px;max-height:320px;overflow:auto;z-index:300;min-width:280px;padding:4px;box-shadow:0 6px 18px rgba(0,0,0,0.6);">
					<!-- options populated dynamically -->
				</div>
			</div>
			<input id="rate-input" type="number" min="0.1" step="0.1" placeholder="Rate per minute">
			<label for="optimize-select" style="margin-left:1rem;">Optimize by:</label>
			<select id="optimize-select">
				<option value="space">Space</option>
				<option value="power">Power</option>
				<option value="buildings">Buildings</option>
			</select>
				<button id="edit-available-items-btn" style="margin-left:1rem;">Set Available Items</button>

				<!-- Modal for available items -->
					<div id="available-items-modal" style="display:none;position:fixed;z-index:1000;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;">
						<div style="background:#23272b;padding:2rem 2.5rem;border-radius:12px;min-width:350px;max-width:90vw;max-height:80vh;overflow-y:auto;">
						<h2 style="margin-top:0;">Set Available Items</h2>
						<form id="available-items-form">
							<table id="available-items-table" style="width:100%;margin-bottom:1rem;">
								<thead><tr><th>Item</th><th>Amount</th><th></th></tr></thead>
								<tbody></tbody>
							</table>
							<button type="button" id="add-available-item-row">Add New Item</button>
							<div style="margin-top:1.5rem;text-align:right;">
								<button type="button" id="close-available-items-modal" style="margin-right:1rem;">Cancel</button>
								<button type="submit">Save</button>
							</div>
						</form>
					</div>
				</div>
			<button id="calculate-btn">Calculate</button>
		</div>
		<div class="production-plan" id="production-plan">
			<div style="display: flex; flex-direction: row; gap: 2rem;">
				<div style="flex: 1; min-width: 350px;">
					<div class="placeholder-graph">
						Production plan will appear here as a tree/graph.<br>
						(Icons, rates, and buildings will be shown)
					</div>
					<div id="plan-tree-html"></div>
				</div>
				<div style="flex: 2; min-width: 400px;">
					<div id="network-graph" style="width:100%;height:500px;background:#222;border-radius:8px;"></div>
				</div>
			</div>
		</div>
		<!-- Vis Network CDN -->
		<script type="text/javascript" src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
		<link href="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.css" rel="stylesheet" type="text/css" />
		<script>
		// --- Data structures for Automate It ---
	const items = {
		AdvSolarModuleWithPanel: { name: 'Advanced Solar Module With Panel', icon: 'Icons/T_Icon_advsolarmodulewithpanel.PNG', type: 'solid' },
		AdvancedHeatSink: { name: 'Advanced Heat Sink', icon: 'Icons/T_Icon_advancedheatsink.PNG', type: 'solid' },
		AdvancedOpticalInverter: { name: 'Advanced Optical Inverter', icon: 'Icons/T_Icon_advancedopticalinverter.PNG', type: 'solid' },
		AdvancedSolarModule: { name: 'Advanced Solar Module', icon: 'Icons/T_Icon_advancedsolarmodule.PNG', type: 'solid' },
		AdvancedSolarTransmitter: { name: 'Advanced Solar Transmitter', icon: 'Icons/T_Icon_advancedsolartransmitter.PNG', type: 'solid' },
		AlkalineCrystallizationAgent: { name: 'Alkaline Crystallization Agent', icon: 'Icons/T_Icon_alkalinecrystallizationagent.PNG', type: 'solid' },
		AlloySuspendedMagneticFieldGenerator: { name: 'Alloy Suspended Magnetic Field Generator', icon: 'Icons/T_Icon_alloysuspendedmagneticfieldgenerator.PNG', type: 'solid' },
		Aluminum: { name: 'Aluminum', icon: 'Icons/T_Icon_aluminum.PNG', type: 'solid' },
		AluminumBar: { name: 'Aluminum Bar', icon: 'Icons/T_Icon_aluminumbar.PNG', type: 'solid' },
		AluminumCoating: { name: 'Aluminum Coating', icon: 'Icons/T_Icon_aluminumcoating.PNG', type: 'solid' },
		AluminumFrame: { name: 'Aluminum Frame', icon: 'Icons/T_Icon_aluminumframe.PNG', type: 'solid' },
		AluminumIngot: { name: 'Aluminum Ingot', icon: 'Icons/T_Icon_aluminumingot.PNG', type: 'solid' },
		AluminumProfile: { name: 'Aluminum Profile', icon: 'Icons/T_Icon_aluminumprofile.PNG', type: 'solid' },
		AstralEtherLens: { name: 'Astral Ether Lens', icon: 'Icons/T_Icon_astraletherlens.PNG', type: 'solid' },
		AstralInfusedProcessingCrystal: { name: 'Astral Infused Processing Crystal', icon: 'Icons/T_Icon_astralinfusedprocessingcrystal.PNG', type: 'solid' },
		AstralPowerCore: { name: 'Astral Power Core', icon: 'Icons/T_Icon_astralpowercore.PNG', type: 'solid' },
		AstralShadowModule: { name: 'Astral Shadow Module', icon: 'Icons/T_Icon_astralshadowmodule.PNG', type: 'solid' },
		AstralShadowOcilator: { name: 'Astral Shadow Ocilator', icon: 'Icons/T_Icon_astralshadowocilator.PNG', type: 'solid' },
		AstralSignalTransponder: { name: 'Astral Signal Transponder', icon: 'Icons/T_Icon_astralsignaltransponder.PNG', type: 'solid' },
		AstralVoidEnergyCascade: { name: 'Astral Void Energy Cascade', icon: 'Icons/T_Icon_astralvoidenergycascade.PNG', type: 'solid' },
		Astralite: { name: 'Astralite', icon: 'Icons/T_Icon_astralite.PNG', type: 'solid' },
		AstraliteFragment: { name: 'Astralite Fragment', icon: 'Icons/T_Icon_astralitefragment.PNG', type: 'solid' },
		AstraliteInfusedCore: { name: 'Astralite Infused Core', icon: 'Icons/T_Icon_astraliteinfusedcore.PNG', type: 'solid' },
		AstraliteReinforcementPanel: { name: 'Astralite Reinforcement Panel', icon: 'Icons/T_Icon_astralitereinforcementpanel.PNG', type: 'solid' },
		AstraliteSingularityDrive: { name: 'Astralite Singularity Drive', icon: 'Icons/T_Icon_astralitesingularitydrive.PNG', type: 'solid' },
		AutoIrrigation: { name: 'Auto Irrigation', icon: 'Icons/T_Icon_autoirrigation.PNG', type: 'solid' },
		AutomatedSingularityConverter: { name: 'Automated Singularity Converter', icon: 'Icons/T_Icon_automatedsingularityconverter.PNG', type: 'solid' },
		AutomaticControlPanel: { name: 'Automatic Control Panel', icon: 'Icons/T_Icon_automaticcontrolpanel.PNG', type: 'solid' },
		AutomaticGreenhouse: { name: 'Automatic Greenhouse', icon: 'Icons/T_Icon_automaticgreenhouse.PNG', type: 'solid' },
		Barrel: { name: 'Barrel', icon: 'Icons/T_Icon_barrel.PNG', type: 'solid' },
		BarrelOfAstralShadow: { name: 'Barrel Of Astral Shadow', icon: 'Icons/T_Icon_barrelofastralshadow.PNG', type: 'solid' },
		Basalt: { name: 'Basalt', icon: 'Icons/T_Icon_basalt.PNG', type: 'solid' },
		BasaltComposite: { name: 'Basalt Composite', icon: 'Icons/T_Icon_basaltcomposite.PNG', type: 'solid' },
		BasaltHeatSink: { name: 'Basalt Heat Sink', icon: 'Icons/T_Icon_basaltheatsink.PNG', type: 'solid' },
		BioChemicalExtractionUnit: { name: 'Bio Chemical Extraction Unit', icon: 'Icons/T_Icon_biochemicalextractionunit.PNG', type: 'solid' },
		BioeletricExtractionCore: { name: 'Bioeletric Extraction Core', icon: 'Icons/T_Icon_bioeletricextractioncore.PNG', type: 'solid' },
		Biomass: { name: 'Biomass', icon: 'Icons/T_Icon_biomass.PNG', type: 'solid' },
		Bitumen: { name: 'Bitumen', icon: 'Icons/T_Icon_bitumen.PNG', type: 'solid' },
		CelestialFluxEngine: { name: 'Celestial Flux Engine', icon: 'Icons/T_Icon_celestialfluxengine.PNG', type: 'solid' },
		ChromiumCrystal: { name: 'Chromium Crystal', icon: 'Icons/T_Icon_chromiumcrystal.PNG', type: 'solid' },
		ChromiumCrystalCore: { name: 'Chromium Crystal Core', icon: 'Icons/T_Icon_chromiumcrystalcore.PNG', type: 'solid' },
		ChromiumCrystalWafer: { name: 'Chromium Crystal Wafer', icon: 'Icons/T_Icon_chromiumcrystalwafer.PNG', type: 'solid' },
		ChromiumLuminaryMatrix: { name: 'Chromium Luminary Matrix', icon: 'Icons/T_Icon_chromiumluminarymatrix.PNG', type: 'solid' },
		ChronoReactorCoil: { name: 'Chrono Reactor Coil', icon: 'Icons/T_Icon_chronoreactorcoil.PNG', type: 'solid' },
		ChronoResonanceMatrix: { name: 'Chrono Resonance Matrix', icon: 'Icons/T_Icon_chronoresonancematrix.PNG', type: 'solid' },
		ChronoShadowPlate: { name: 'Chrono Shadow Plate', icon: 'Icons/T_Icon_chronoshadowplate.PNG', type: 'solid' },
		CircuitMemoryArray: { name: 'Circuit Memory Array', icon: 'Icons/T_Icon_circuitmemoryarray.PNG', type: 'solid' },
		Coal: { name: 'Coal', icon: 'Icons/T_Icon_coal.PNG', type: 'solid' },
		CompressedAlloyQuantumSandwich: { name: 'Compressed Alloy Quantum Sandwich', icon: 'Icons/T_Icon_compressedalloyquantumsandwich.PNG', type: 'solid' },
		CompressedBasalt: { name: 'Compressed Basalt', icon: 'Icons/T_Icon_compressedbasalt.PNG', type: 'solid' },
		CompressedShadowOpal: { name: 'Compressed Shadow Opal', icon: 'Icons/T_Icon_compressedshadowopal.PNG', type: 'solid' },
		Concrete: { name: 'Concrete', icon: 'Icons/T_Icon_concrete.PNG', type: 'solid' },
		ConcreteBlock: { name: 'Concrete Block', icon: 'Icons/T_Icon_concreteblock.PNG', type: 'solid' },
		CondensedEtherPulseEngine: { name: 'Condensed Ether Pulse Engine', icon: 'Icons/T_Icon_condensedetherpulseengine.PNG', type: 'solid' },
		Copper: { name: 'Copper', icon: 'Icons/T_Icon_copper.PNG', type: 'solid' },
		CopperBars: { name: 'Copper Bars', icon: 'Icons/T_Icon_copperbars.PNG', type: 'solid' },
		CopperFilament: { name: 'Copper Filament', icon: 'Icons/T_Icon_copperfilament.PNG', type: 'solid' },
		CopperPipe: { name: 'Copper Pipe', icon: 'Icons/T_Icon_copperpipe.PNG', type: 'solid' },
		CosmicGallon: { name: 'Cosmic Gallon', icon: 'Icons/T_Icon_cosmicgallon.PNG', type: 'solid' },
		CryogenicFuelCell: { name: 'Cryogenic Fuel Cell', icon: 'Icons/T_Icon_cryogenicfuelcell.PNG', type: 'solid' },
		CrystalPressureModulator: { name: 'Crystal Pressure Modulator', icon: 'Icons/T_Icon_crystalpressuremodulator.PNG', type: 'solid' },
		CrystallineSynchronizationPlate: { name: 'Crystalline Synchronization Plate', icon: 'Icons/T_Icon_crystallinesynchronizationplate.PNG', type: 'solid' },
		CrystallizedDiamondCore: { name: 'Crystallized Diamond Core', icon: 'Icons/T_Icon_crystallizeddiamondcore.PNG', type: 'solid' },
		DeepCoreSensorNode: { name: 'Deep Core Sensor Node', icon: 'Icons/T_Icon_deepcoresensornode.PNG', type: 'solid' },
		Diamond: { name: 'Diamond', icon: 'Icons/T_Icon_diamond.PNG', type: 'solid' },
		DiamondDust: { name: 'Diamond Dust', icon: 'Icons/T_Icon_diamonddust.PNG', type: 'solid' },
		DiamondSingularityCore: { name: 'Diamond Singularity Core', icon: 'Icons/T_Icon_diamondsingularitycore.PNG', type: 'solid' },
		EnergizedCrystalLens: { name: 'Energized Crystal Lens', icon: 'Icons/T_Icon_energizedcrystallens.PNG', type: 'solid' },
		EnrichedUraniumPellet: { name: 'Enriched Uranium Pellet', icon: 'Icons/T_Icon_enricheduraniumpellet.PNG', type: 'solid' },
		EtherGuidedFlowRod: { name: 'Ether Guided Flow Rod', icon: 'Icons/T_Icon_etherguidedflowrod.PNG', type: 'solid' },
		EtherQuartz: { name: 'Ether Quartz', icon: 'Icons/T_Icon_etherquartz.PNG', type: 'solid' },
		EtherealChromiumEngine: { name: 'Ethereal Chromium Engine', icon: 'Icons/T_Icon_etherealchromiumengine.PNG', type: 'solid' },
		EtherealPrismaticSphere: { name: 'Ethereal Prismatic Sphere', icon: 'Icons/T_Icon_etherealprismaticsphere.PNG', type: 'solid' },
		EthericControlModule: { name: 'Etheric Control Module', icon: 'Icons/T_Icon_ethericcontrolmodule.PNG', type: 'solid' },
		EtheriumShadowPlate: { name: 'Etherium Shadow Plate', icon: 'Icons/T_Icon_etheriumshadowplate.PNG', type: 'solid' },
		FiltredWaterGallon: { name: 'Filtred Water Gallon', icon: 'Icons/T_Icon_filtredwatergallon.PNG', type: 'solid' },
		Fluorite: { name: 'Fluorite', icon: 'Icons/T_Icon_fluorite.PNG', type: 'solid' },
		FractalProcessingPrism: { name: 'Fractal Processing Prism', icon: 'Icons/T_Icon_fractalprocessingprism.PNG', type: 'solid' },
		FracturedSingularityMesh: { name: 'Fractured Singularity Mesh', icon: 'Icons/T_Icon_fracturedsingularitymesh.PNG', type: 'solid' },
		FusionFieldStabilizer: { name: 'Fusion Field Stabilizer', icon: 'Icons/T_Icon_fusionfieldstabilizer.PNG', type: 'solid' },
		FusionFuelRod: { name: 'Fusion Fuel Rod', icon: 'Icons/T_Icon_fusionfuelrod.PNG', type: 'solid' },
		Gallon: { name: 'Gallon', icon: 'Icons/T_Icon_gallon.PNG', type: 'solid' },
		Glass: { name: 'Glass', icon: 'Icons/T_Icon_glass.PNG', type: 'solid' },
		GravitationalCoreProcessor: { name: 'Gravitational Core Processor', icon: 'Icons/T_Icon_gravitationalcoreprocessor.PNG', type: 'solid' },
		HVTransformer: { name: 'HV Transformer', icon: 'Icons/T_Icon_hvtransformer.PNG', type: 'solid' },
		HardenedQuartzPlate: { name: 'Hardened Quartz Plate', icon: 'Icons/T_Icon_hardenedquartzplate.PNG', type: 'solid' },
		HyperconductiveProcessingUnit: { name: 'Hyperconductive Processing Unit', icon: 'Icons/T_Icon_hyperconductiveprocessingunit.PNG', type: 'solid' },
		IonFluxBeamEmitter: { name: 'Ion Flux Beam Emitter', icon: 'Icons/T_Icon_ionfluxbeamemitter.PNG', type: 'solid' },
		Iridium: { name: 'Iridium', icon: 'Icons/T_Icon_iridium.PNG', type: 'solid' },
		IridiumCatalyst: { name: 'Iridium Catalyst', icon: 'Icons/T_Icon_iridiumcatalyst.PNG', type: 'solid' },
		IridiumPlatedCable: { name: 'Iridium Plated Cable', icon: 'Icons/T_Icon_iridiumplatedcable.PNG', type: 'solid' },
		IridiumReflector: { name: 'Iridium Reflector', icon: 'Icons/T_Icon_iridiumreflector.PNG', type: 'solid' },
		Iron: { name: 'Iron', icon: 'Icons/T_Icon_iron.PNG', type: 'solid' },
		IronBar: { name: 'Iron Bar', icon: 'Icons/T_Icon_ironbar.PNG', type: 'solid' },
		IronIngot: { name: 'Iron Ingot', icon: 'Icons/T_Icon_ironingot.PNG', type: 'solid' },
		IronPipe: { name: 'Iron Pipe', icon: 'Icons/T_Icon_ironpipe.PNG', type: 'solid' },
		IrrigationSystem: { name: 'Irrigation System', icon: 'Icons/T_Icon_irrigationsystem.PNG', type: 'solid' },
		LVTransformer: { name: 'LV Transformer', icon: 'Icons/T_Icon_lvtransformer.PNG', type: 'solid' },
		LatticeEncodedMemoryBank: { name: 'Lattice Encoded Memory Bank', icon: 'Icons/T_Icon_latticeencodedmemorybank.PNG', type: 'solid' },
		LatticeReinforcedConduit: { name: 'Lattice Reinforced Conduit', icon: 'Icons/T_Icon_latticereinforcedconduit.PNG', type: 'solid' },
		LuminaryCrystalCore: { name: 'Luminary Crystal Core', icon: 'Icons/T_Icon_luminarycrystalcore.PNG', type: 'solid' },
		MagneticCoolingRegulator: { name: 'Magnetic Cooling Regulator', icon: 'Icons/T_Icon_magneticcoolingregulator.PNG', type: 'solid' },
		MagneticIndunctionCoil: { name: 'Magnetic Induction Coil', icon: 'Icons/T_Icon_magneticindunctioncoil.PNG', type: 'solid' },
		MagneticNickelRod: { name: 'Magnetic Nickel Rod', icon: 'Icons/T_Icon_magneticnickelrod.PNG', type: 'solid' },
		MultiphaseAlloyReactor: { name: 'Multiphase Alloy Reactor', icon: 'Icons/T_Icon_multiphasealloyreactor.PNG', type: 'solid' },
		NanoInsulatedWiringSet: { name: 'Nano Insulated Wiring Set', icon: 'Icons/T_Icon_nanoinsulatedwiringset.PNG', type: 'solid' },
		NanoMagneticFlowRegulator: { name: 'Nano Magnetic Flow Regulator', icon: 'Icons/T_Icon_nanomagneticflowregulator.PNG', type: 'solid' },
		NebulaInfusedOpal: { name: 'Nebula Infused Opal', icon: 'Icons/T_Icon_nebulainfusedopal.PNG', type: 'solid' },
		Nebulite: { name: 'Nebulite', icon: 'Icons/T_Icon_nebulite.PNG', type: 'solid' },
		NebulitePrism: { name: 'Nebulite Prism', icon: 'Icons/T_Icon_nebuliteprism.PNG', type: 'solid' },
		NeuralControlInterface: { name: 'Neural Control Interface', icon: 'Icons/T_Icon_neuralcontrolinterface.PNG', type: 'solid' },
		NeuralPhaseThread: { name: 'Neural Phase Thread', icon: 'Icons/T_Icon_neuralphasethread.PNG', type: 'solid' },
		NeutronFluxGenerator: { name: 'Neutron Flux Generator', icon: 'Icons/T_Icon_neutronfluxgenerator.PNG', type: 'solid' },
		NeutronStabilizedCore: { name: 'Neutron Stabilized Core', icon: 'Icons/T_Icon_neutronstabilizedcore.PNG', type: 'solid' },
		NeutroniumStabilizationBrace: { name: 'Neutronium Stabilization Brace', icon: 'Icons/T_Icon_neutroniumstabilizationbrace.PNG', type: 'solid' },
		NeutronizedCoolingPillar: { name: 'Neutronized Cooling Pillar', icon: 'Icons/T_Icon_neutronizedcoolingpillar.PNG', type: 'solid' },
		Nickel: { name: 'Nickel', icon: 'Icons/T_Icon_nickel.PNG', type: 'solid' },
		NickelInfusedWire: { name: 'Nickel Infused Wire', icon: 'Icons/T_Icon_nickelinfusedwire.PNG', type: 'solid' },
		OminidirectionalHeatFilter: { name: 'Ominidirectional Heat Filter', icon: 'Icons/T_Icon_ominidirectionalheatfilter.PNG', type: 'solid' },
		OmniFusedRelayAmplifier: { name: 'Omni Fused Relay Amplifier', icon: 'Icons/T_Icon_omnifusedrelayamplifier.PNG', type: 'solid' },
		OmniversalEnergyNexus: { name: 'Omniversal Energy Nexus', icon: 'Icons/T_Icon_omniversalenergynexus.PNG', type: 'solid' },
		Osmium: { name: 'Osmium', icon: 'Icons/T_Icon_osmium.PNG', type: 'solid' },
		OsmiumFilament: { name: 'Osmium Filament', icon: 'Icons/T_Icon_osmiumfilament.PNG', type: 'solid' },
		OsmiumReinforcement: { name: 'Osmium Reinforcement', icon: 'Icons/T_Icon_osmiumreinforcement.PNG', type: 'solid' },
		PhaseCompressionArray: { name: 'Phase Compression Array', icon: 'Icons/T_Icon_phasecompressionarray.PNG', type: 'solid' },
		PhaseSyncedRelayCircuit: { name: 'Phase Synced Relay Circuit', icon: 'Icons/T_Icon_phasesyncedrelaycircuit.PNG', type: 'solid' },
		PhotonicDiamondLayer: { name: 'Photonic Diamond Layer', icon: 'Icons/T_Icon_photonicdiamondlayer.PNG', type: 'solid' },
		PlasmaConductorArray: { name: 'Plasma Conductor Array', icon: 'Icons/T_Icon_plasmaconductorarray.PNG', type: 'solid' },
		Plastic: { name: 'Plastic', icon: 'Icons/T_Icon_plastic.PNG', type: 'solid' },
		PlasticFrame: { name: 'Plastic Frame', icon: 'Icons/T_Icon_plasticframe.PNG', type: 'solid' },
		PlasticMold: { name: 'Plastic Mold', icon: 'Icons/T_Icon_plasticmold.PNG', type: 'solid' },
		Platinum: { name: 'Platinum', icon: 'Icons/T_Icon_platinum.PNG', type: 'solid' },
		PlatinumCatalyst: { name: 'Platinum Catalyst', icon: 'Icons/T_Icon_platinumcatalyst.PNG', type: 'solid' },
		PlatinumCoil: { name: 'Platinum Coil', icon: 'Icons/T_Icon_platinumcoil.PNG', type: 'solid' },
		PlatinumPrecisionGear: { name: 'Platinum Precision Gear', icon: 'Icons/T_Icon_platinumprecisiongear.PNG', type: 'solid' },
		PlatonicMemoryCore: { name: 'Platonic Memory Core', icon: 'Icons/T_Icon_platonicmemorycore.PNG', type: 'solid' },
		PolycrystallineSilicon: { name: 'Polycrystalline Silicon', icon: 'Icons/T_Icon_polycrystallinesilicon.PNG', type: 'solid' },
		PowerCable: { name: 'Power Cable', icon: 'Icons/T_Icon_powercable.PNG', type: 'solid' },
		PulseEnergyMatrix: { name: 'Pulse Energy Matrix', icon: 'Icons/T_Icon_pulseenergymatrix.PNG', type: 'solid' },
		QuantumCooledReactorCasing: { name: 'Quantum Cooled Reactor Casing', icon: 'Icons/T_Icon_quantumcooledreactorcasing.PNG', type: 'solid' },
		QuantumDataCompressor: { name: 'Quantum Data Compressor', icon: 'Icons/T_Icon_quantumdatacompressor.PNG', type: 'solid' },
		QuantumNebuliteSphere: { name: 'Quantum Nebulite Sphere', icon: 'Icons/T_Icon_quantumnebulitesphere.PNG', type: 'solid' },
		QuantumQuartzCore: { name: 'Quantum Quartz Core', icon: 'Icons/T_Icon_quantumquartzcore.PNG', type: 'solid' },
		QuantumResonantLensCore: { name: 'Quantum Resonant Lens Core', icon: 'Icons/T_Icon_quantumresonantlenscore.PNG', type: 'solid' },
		QuantumSignalRelay: { name: 'Quantum Signal Relay', icon: 'Icons/T_Icon_quantumsignalrelay.PNG', type: 'solid' },
		QuantumStabilizedAlloy: { name: 'Quantum Stabilized Alloy', icon: 'Icons/T_Icon_quantumstabilizedalloy.PNG', type: 'solid' },
		Quartz: { name: 'Quartz', icon: 'Icons/T_Icon_quartz.PNG', type: 'solid' },
		QuartzInsulatedGlass: { name: 'Quartz Insulated Glass', icon: 'Icons/T_Icon_quartzinsulatedglass.PNG', type: 'solid' },
		RadiantCrystalAmplifier: { name: 'Radiant Crystal Amplifier', icon: 'Icons/T_Icon_radiantcrystalamplifier.PNG', type: 'solid' },
		RadiationShieldingPanel: { name: 'Radiation Shielding Panel', icon: 'Icons/T_Icon_radiationshieldingpanel.PNG', type: 'solid' },
		RailwayTrack: { name: 'Railway Track', icon: 'Icons/T_Icon_railwaytrack.PNG', type: 'solid' },
		Railwayline: { name: 'Railway Line', icon: 'Icons/T_Icon_railwayline.PNG', type: 'solid' },
		ReactiveAlloyCasing: { name: 'Reactive Alloy Casing', icon: 'Icons/T_Icon_reactivealloycasing.PNG', type: 'solid' },
		ReactiveFlowManipulator: { name: 'Reactive Flow Manipulator', icon: 'Icons/T_Icon_reactiveflowmanipulator.PNG', type: 'solid' },
		RefinedEtherQuartz: { name: 'Refined Ether Quartz', icon: 'Icons/T_Icon_refinedetherquartz.PNG', type: 'solid' },
		RefinedUraniumRod: { name: 'Refined Uranium Rod', icon: 'Icons/T_Icon_refineduraniumrod.PNG', type: 'solid' },
		ReinforcedAluminumBeams: { name: 'Reinforced Aluminum Beams', icon: 'Icons/T_Icon_reinforcedaluminumbeams.PNG', type: 'solid' },
		ReinforcedConcrete: { name: 'Reinforced Concrete', icon: 'Icons/T_Icon_reinforcedconcrete.PNG', type: 'solid' },
		ReinforcedGlassScreen: { name: 'Reinforced Glass Screen', icon: 'Icons/T_Icon_reinforcedglassscreen.PNG', type: 'solid' },
		ReinforcedNail: { name: 'Reinforced Nail', icon: 'Icons/T_Icon_reinforcednail.PNG', type: 'solid' },
		ReinforcedSteelPlate: { name: 'Reinforced Steel Plate', icon: 'Icons/T_Icon_reinforcedsteelplate.PNG', type: 'solid' },
		Ruby: { name: 'Ruby', icon: 'Icons/T_Icon_ruby.PNG', type: 'solid' },
		RubyCircuitInlay: { name: 'Ruby Circuit Inlay', icon: 'Icons/T_Icon_rubycircuitinlay.PNG', type: 'solid' },
		RubyLens: { name: 'Ruby Lens', icon: 'Icons/T_Icon_rubylens.PNG', type: 'solid' },
		Salt: { name: 'Salt', icon: 'Icons/T_Icon_salt.PNG', type: 'solid' },
		Saphire: { name: 'Sapphire', icon: 'Icons/T_Icon_saphire.PNG', type: 'solid' },
		SapphireConduit: { name: 'Sapphire Conduit', icon: 'Icons/T_Icon_sapphireconduit.PNG', type: 'solid' },
		SapphireEnergyCell: { name: 'Sapphire Energy Cell', icon: 'Icons/T_Icon_sapphireenergycell.PNG', type: 'solid' },
		ShadowNebulaCore: { name: 'Shadow Nebula Core', icon: 'Icons/T_Icon_shadownebulacore.PNG', type: 'solid' },
		ShadowOpal: { name: 'Shadow Opal', icon: 'Icons/T_Icon_shadowopal.PNG', type: 'solid' },
		ShadowOpalShard: { name: 'Shadow Opal Shard', icon: 'Icons/T_Icon_shadowopalshard.PNG', type: 'solid' },
		ShadowglassCapacitor: { name: 'Shadowglass Capacitor', icon: 'Icons/T_Icon_shadowglasscapacitor.PNG', type: 'solid' },
		Silicon: { name: 'Silicon', icon: 'Icons/T_Icon_silicon.PNG', type: 'solid' },
		SiliconDiode: { name: 'Silicon Diode', icon: 'Icons/T_Icon_silicondiode.PNG', type: 'solid' },
		SiliconPlate: { name: 'Silicon Plate', icon: 'Icons/T_Icon_siliconplate.PNG', type: 'solid' },
		Singularity1: { name: 'Singularity 1', icon: 'Icons/T_Icon_singularity1.PNG', type: 'solid' },
		Singularity2: { name: 'Singularity 2', icon: 'Icons/T_Icon_singularity2.PNG', type: 'solid' },
		Singularity3: { name: 'Singularity 3', icon: 'Icons/T_Icon_singularity3.PNG', type: 'solid' },
		Singularity4: { name: 'Singularity 4', icon: 'Icons/T_Icon_singularity4.PNG', type: 'solid' },
		Singularity5: { name: 'Singularity 5', icon: 'Icons/T_Icon_singularity5.PNG', type: 'solid' },
		SingularityInfusedActuator: { name: 'Singularity Infused Actuator', icon: 'Icons/T_Icon_singularityinfusedactuator.PNG', type: 'solid' },
		SolarCell: { name: 'Solar Cell', icon: 'Icons/T_Icon_solarcell.PNG', type: 'solid' },
		SolarControlPanel: { name: 'Solar Control Panel', icon: 'Icons/T_Icon_solarcontrolpanel.PNG', type: 'solid' },
		SolarLantern: { name: 'Solar Lantern', icon: 'Icons/T_Icon_solarlantern.PNG', type: 'solid' },
		SolarLightingModule: { name: 'Solar Lighting Module', icon: 'Icons/T_Icon_solarlightingmodule.PNG', type: 'solid' },
		SolarLightingTower: { name: 'Solar Lighting Tower', icon: 'Icons/T_Icon_solarlightingtower.PNG', type: 'solid' },
		SolarPanel: { name: 'Solar Panel', icon: 'Icons/T_Icon_solarpanel.PNG', type: 'solid' },
		Steel: { name: 'Steel', icon: 'Icons/T_Icon_steel.PNG', type: 'solid' },
		SteelSheets: { name: 'Steel Sheets', icon: 'Icons/T_Icon_steelsheets.PNG', type: 'solid' },
		StellarChromiumModule: { name: 'Stellar Chromium Module', icon: 'Icons/T_Icon_stellarchromiummodule.PNG', type: 'solid' },
		Stone: { name: 'Stone', icon: 'Icons/T_Icon_stone.PNG', type: 'solid' },
		StoneBlock: { name: 'Stone Block', icon: 'Icons/T_Icon_stoneblock.PNG', type: 'solid' },
		StructuralCable: { name: 'Structural Cable', icon: 'Icons/T_Icon_structuralcable.PNG', type: 'solid' },
		Substrate: { name: 'Substrate', icon: 'Icons/T_Icon_substrate.PNG', type: 'solid' },
		Sulfur: { name: 'Sulfur', icon: 'Icons/T_Icon_sulfur.PNG', type: 'solid' },
		SupercompressedPhaseAlloy: { name: 'Supercompressed Phase Alloy', icon: 'Icons/T_Icon_supercompressedphasealloy.PNG', type: 'solid' },
		SuperluminalRelayCore: { name: 'Superluminal Relay Core', icon: 'Icons/T_Icon_superluminalrelaycore.PNG', type: 'solid' },
		SupportBeams: { name: 'Support Beams', icon: 'Icons/T_Icon_supportbeams.PNG', type: 'solid' },
		SynapticFiberCoil: { name: 'Synaptic Fiber Coil', icon: 'Icons/T_Icon_synapticfibercoil.PNG', type: 'solid' },
		SyntheticCircuitSubbrain: { name: 'Synthetic Circuit Subbrain', icon: 'Icons/T_Icon_syntheticcircuitsubbrain.PNG', type: 'solid' },
		TemporalDivergenceArray: { name: 'Temporal Divergence Array', icon: 'Icons/T_Icon_temporaldivergencearray.PNG', type: 'solid' },
		TemporalPrismCircuit: { name: 'Temporal Prism Circuit', icon: 'Icons/T_Icon_temporalprismcircuit.PNG', type: 'solid' },
		TemporalRefractionInverter: { name: 'Temporal Refraction Inverter', icon: 'Icons/T_Icon_temporalrefractioninverter.PNG', type: 'solid' },
		ThermoeletricInterfaceChip: { name: 'Thermoelectric Interface Chip', icon: 'Icons/T_Icon_thermoeletricinterfacechip.PNG', type: 'solid' },
		TitaniuMesh: { name: 'Titanium Mesh', icon: 'Icons/T_Icon_titaniumesh.PNG', type: 'solid' },
		Titanium: { name: 'Titanium', icon: 'Icons/T_Icon_titanium.PNG', type: 'solid' },
		TitaniumAlloyPlate: { name: 'Titanium Alloy Plate', icon: 'Icons/T_Icon_titaniumalloyplate.PNG', type: 'solid' },
		TitaniumInfusionEngine: { name: 'Titanium Infusion Engine', icon: 'Icons/T_Icon_titaniuminfusionengine.PNG', type: 'solid' },
		TitaniumLattice: { name: 'Titanium Lattice', icon: 'Icons/T_Icon_titaniumlattice.PNG', type: 'solid' },
		TriCrystalFusionNode: { name: 'Tri-Crystal Fusion Node', icon: 'Icons/T_Icon_tricrystalfusionnode.PNG', type: 'solid' },
		TunedQuantumProcessor: { name: 'Tuned Quantum Processor', icon: 'Icons/T_Icon_tunedquantumprocessor.PNG', type: 'solid' },
		Uranium: { name: 'Uranium', icon: 'Icons/T_Icon_uranium.PNG', type: 'solid' },
		UraniumIonCell: { name: 'Uranium Ion Cell', icon: 'Icons/T_Icon_uraniumioncell.PNG', type: 'solid' },
		VoidNebulaReactor: { name: 'Void Nebula Reactor', icon: 'Icons/T_Icon_voidnebulareactor.PNG', type: 'solid' },
		VoidStabilizedContainmentRing: { name: 'Void Stabilized Containment Ring', icon: 'Icons/T_Icon_voidstabilizedcontainmentring.PNG', type: 'solid' },
		VoidglassFocusingArray: { name: 'Voidglass Focusing Array', icon: 'Icons/T_Icon_voidglassfocusingarray.PNG', type: 'solid' },
		VoidglassImplosionDamper: { name: 'Voidglass Implosion Damper', icon: 'Icons/T_Icon_voidglassimplosiondamper.PNG', type: 'solid' },
		WaterFiltrationDevice: { name: 'Water Filtration Device', icon: 'Icons/T_Icon_waterfiltrationdevice.PNG', type: 'solid' },
		Wood: { name: 'Wood', icon: 'Icons/T_Icon_wood.PNG', type: 'solid' },
		WoodBoard: { name: 'Wood Board', icon: 'Icons/T_Icon_woodboard.PNG', type: 'solid' },
		WoodPlank: { name: 'Wood Plank', icon: 'Icons/T_Icon_woodplank.PNG', type: 'solid' },
		Zinc: { name: 'Zinc', icon: 'Icons/T_Icon_zinc.PNG', type: 'solid' },
		ZincCarbonMatrix: { name: 'Zinc Carbon Matrix', icon: 'Icons/T_Icon_zinccarbonmatrix.PNG', type: 'solid' },
		ZincPlating: { name: 'Zinc Plating', icon: 'Icons/T_Icon_zincplating.PNG', type: 'solid' },
		Brine: { name: 'Brine', icon: 'Icons/T_Icon_brine.PNG', type: 'nonsolid' },
		Chloride: { name: 'Chloride', icon: 'Icons/T_Icon_chloride.PNG', type: 'nonsolid' },
		ChromiumSuspension: { name: 'Chromium Suspension', icon: 'Icons/T_Icon_chromiumsuspension.PNG', type: 'nonsolid' },
		ChronoCatalystGel: { name: 'Chrono Catalyst Gel', icon: 'Icons/T_Icon_chronocatalystgel.PNG', type: 'nonsolid' },
		CompressedAstralShadow: { name: 'Compressed Astral Shadow', icon: 'Icons/T_Icon_compressedastralshadow.PNG', type: 'nonsolid' },
		CompressedTransformationSingularity: { name: 'Compressed Transformation Singularity', icon: 'Icons/T_Icon_compressedtransformationsingularity.PNG', type: 'nonsolid' },
		CondensedHelium3: { name: 'Condensed Helium-3', icon: 'Icons/T_Icon_condensedhelium3.PNG', type: 'nonsolid' },
		CooperFluxVapor: { name: 'Copper Flux Vapor', icon: 'Icons/T_Icon_cooperfluxvapor.PNG', type: 'nonsolid' },
		CopperFluxSuspension: { name: 'Copper Flux Suspension', icon: 'Icons/T_Icon_copperfluxsuspension.PNG', type: 'nonsolid' },
		CryoalkalineSolution: { name: 'Cryoalkaline Solution', icon: 'Icons/T_Icon_cryoalkalinesolution.PNG', type: 'nonsolid' },
		Deuterium: { name: 'Deuterium', icon: 'Icons/T_Icon_deuterium.PNG', type: 'nonsolid' },
		DiamondSlurry: { name: 'Diamond Slurry', icon: 'Icons/T_Icon_diamondslurry.PNG', type: 'nonsolid' },
		EthericBinderGel: { name: 'Etheric Binder Gel', icon: 'Icons/T_Icon_ethericbindergel.PNG', type: 'nonsolid' },
		Ethylene: { name: 'Ethylene', icon: 'Icons/T_Icon_ethylene.PNG', type: 'nonsolid' },
		FiltratedWater: { name: 'Filtrated Water', icon: 'Icons/T_Icon_filtratedwater.PNG', type: 'nonsolid' },
		HeavyOil: { name: 'Heavy Oil', icon: 'Icons/T_Icon_heavyoil.PNG', type: 'nonsolid' },
		HeavyWater: { name: 'Heavy Water', icon: 'Icons/T_Icon_heavywater.PNG', type: 'nonsolid' },
		Helium3: { name: 'Helium-3', icon: 'Icons/T_Icon_helium3.PNG', type: 'nonsolid' },
		HydrofluoricAcid: { name: 'Hydrofluoric Acid', icon: 'Icons/T_Icon_hydrofluoricacid.PNG', type: 'nonsolid' },
		Hydrogen: { name: 'Hydrogen', icon: 'Icons/T_Icon_hydrogen.PNG', type: 'nonsolid' },
		HydrogenChloride: { name: 'Hydrogen Chloride', icon: 'Icons/T_Icon_hydrogenchloride.PNG', type: 'nonsolid' },
		IonizedHydrogen: { name: 'Ionized Hydrogen', icon: 'Icons/T_Icon_ionizedhydrogen.PNG', type: 'nonsolid' },
		IridiumSolution: { name: 'Iridium Solution', icon: 'Icons/T_Icon_iridiumsolution.PNG', type: 'nonsolid' },
		LightOil: { name: 'Light Oil', icon: 'Icons/T_Icon_lightoil.PNG', type: 'nonsolid' },
		LiquidChloride: { name: 'Liquid Chloride', icon: 'Icons/T_Icon_liquidchloride.PNG', type: 'nonsolid' },
		LiquidDeuterium: { name: 'Liquid Deuterium', icon: 'Icons/T_Icon_liquiddeuterium.PNG', type: 'nonsolid' },
		LiquidHydrofluoricAcid: { name: 'Liquid Hydrofluoric Acid', icon: 'Icons/T_Icon_liquidhydrofluoricacid.PNG', type: 'nonsolid' },
		LiquidHydrogen: { name: 'Liquid Hydrogen', icon: 'Icons/T_Icon_liquidhydrogen.PNG', type: 'nonsolid' },
		LiquidHydrogenChloride: { name: 'Liquid Hydrogen Chloride', icon: 'Icons/T_Icon_liquidhydrogenchloride.PNG', type: 'nonsolid' },
		LiquidNitrogen: { name: 'Liquid Nitrogen', icon: 'Icons/T_Icon_liquidnitrogen.PNG', type: 'nonsolid' },
		LiquidOxygen: { name: 'Liquid Oxygen', icon: 'Icons/T_Icon_liquidoxygen.PNG', type: 'nonsolid' },
		LiquidTransformationSingularity: { name: 'Liquid Transformation Singularity', icon: 'Icons/T_Icon_liquidtransformationsingularity.PNG', type: 'nonsolid' },
		MeltedAstralShadow: { name: 'Melted Astral Shadow', icon: 'Icons/T_Icon_meltedastralshadow.PNG', type: 'nonsolid' },
		MeltedWaterFilter: { name: 'Melted Water Filter', icon: 'Icons/T_Icon_meltedwaterfilter.PNG', type: 'nonsolid' },
		Nitrogen: { name: 'Nitrogen', icon: 'Icons/T_Icon_nitrogen.PNG', type: 'nonsolid' },
		Oil: { name: 'Oil', icon: 'Icons/T_Icon_oil.PNG', type: 'nonsolid' },
		Oxygen: { name: 'Oxygen', icon: 'Icons/T_Icon_oxygen.PNG', type: 'nonsolid' },
		PlasmaArcEnergy: { name: 'Plasma Arc Energy', icon: 'Icons/T_Icon_plasmaarcenergy.PNG', type: 'nonsolid' },
		QuantumEnergySolution: { name: 'Quantum Energy Solution', icon: 'Icons/T_Icon_quantumenergysolution.PNG', type: 'nonsolid' },
		QuantumPlasma: { name: 'Quantum Plasma', icon: 'Icons/T_Icon_quantumplasma.PNG', type: 'nonsolid' },
		Sodium: { name: 'Sodium', icon: 'Icons/T_Icon_sodium.PNG', type: 'nonsolid' },
		SodiumHydroxide: { name: 'Sodium Hydroxide', icon: 'Icons/T_Icon_sodiumhydroxide.PNG', type: 'nonsolid' },
		StabilizedIridiumMatrix: { name: 'Stabilized Iridium Matrix', icon: 'Icons/T_Icon_stabilizediridiummatrix.PNG', type: 'nonsolid' },
		SulfurDioxide: { name: 'Sulfur Dioxide', icon: 'Icons/T_Icon_sulfurdioxide.PNG', type: 'nonsolid' },
		SulfurTrioxide: { name: 'Sulfur Trioxide', icon: 'Icons/T_Icon_sulfurtrioxide.PNG', type: 'nonsolid' },
		SulfuricAcid: { name: 'Sulfuric Acid', icon: 'Icons/T_Icon_sulfuricacid.PNG', type: 'nonsolid' },
		SuperheatedPlasmaCore: { name: 'Superheated Plasma Core', icon: 'Icons/T_Icon_superheatedplasmacore.PNG', type: 'nonsolid' },
		TemporalCircuitSlurry: { name: 'Temporal Circuit Slurry', icon: 'Icons/T_Icon_temporalcircuitslurry.PNG', type: 'nonsolid' },
		UraniumSuspension: { name: 'Uranium Suspension', icon: 'Icons/T_Icon_uraniumsuspension.PNG', type: 'nonsolid' },
		Water: { name: 'Water', icon: 'Icons/T_Icon_water.PNG', type: 'nonsolid' },
		WaterSteam: { name: 'Water Steam', icon: 'Icons/T_Icon_watersteam.PNG', type: 'nonsolid' },
		ZincSolution: { name: 'Zinc Solution', icon: 'Icons/T_Icon_zincsolution.PNG', type: 'nonsolid' },
		catalyzedcarbonbinder: { name: 'Catalyzed Carbon Binder', icon: 'Icons/T_Icon_catalyzedcarbonbinder.PNG', type: 'nonsolid' },
		etherealcoolant: { name: 'Ethereal Coolant', icon: 'Icons/T_Icon_etherealcoolant.PNG', type: 'nonsolid' },
		hypercooledsuperfluid: { name: 'Hypercooled Superfluid', icon: 'Icons/T_Icon_hypercooledsuperfluid.PNG', type: 'nonsolid' },
		liquidcarbon: { name: 'Liquid Carbon', icon: 'Icons/T_Icon_liquidcarbon.PNG', type: 'nonsolid' },
		plasmalinkedcatalystgel: { name: 'Plasmalinked Catalyst Gel', icon: 'Icons/T_Icon_plasmalinkedcatalystgel.PNG', type: 'nonsolid' },
		reinforceduraniumsuspension: { name: 'Reinforced Uranium Suspension', icon: 'Icons/T_Icon_reinforceduraniumsuspension.PNG', type: 'nonsolid' },
		shadowopalsolution: { name: 'Shadow Opal Solution', icon: 'Icons/T_Icon_shadowopalsolution.PNG', type: 'nonsolid' },
		stabilizedethericalkalinebase: { name: 'Stabilized Etheric Alkaline Base', icon: 'Icons/T_Icon_stabilizedethericalkalinebase.PNG', type: 'nonsolid' },
		stabilizedopalslurry: { name: 'Stabilized Opal Slurry', icon: 'Icons/T_Icon_stabilizedopalslurry.PNG', type: 'nonsolid' },
		voidreactionslurry: { name: 'Void Reaction Slurry', icon: 'Icons/T_Icon_voidreactionslurry.PNG', type: 'nonsolid' },
		voidstabilizer: { name: 'Void Stabilizer', icon: 'Icons/T_Icon_voidstabilizer.PNG', type: 'nonsolid' },
	}
	const buildings = {
		press: { name: 'Press', power: 10, space: 10 },
		furnace: { name: 'Furnace', power: 10, space: 10 },
		cutter: { name: 'Cutter', power: 8, space: 2 },
		welder: { name: 'Welder', power: 15, space: 17 },
		advanced_furnace: { name: 'Advanced Furnace', power: 20, space: 76 },
		advanced_cutter: { name: 'Advanced Cutter', power: 15, space: 24 },
		advanced_press: { name: 'Advanced Press', power: 20, space: 23 },
		manufacturer: { name: 'Manufacturer', power: 15, space: 9 },
        bifluxor: { name: 'Bifluxor', power: 30, space: 48 },
		chemical_infuser: { name: 'Chemical Infuser', power: 45, space: 80 },
		storage_packing: { name: 'Storage Packing', power: 50, space: 100 },
		dissolution_chamber: { name: 'Dissolution Chamber', power: 25, space: 22 },
		distilation_column: { name: 'Distilation Column', power: 30, space: 22 },
		};
	const recipes = [
            {
                name: "Plastic Molds (Dissolution Chamber)",
                building: "dissolution_chamber",
                inputs: [
                    { item: "plastic", rate: 120 },
                    { item: "liquid_chloride", rate: 60 }
                ],
                outputs: [
                    { item: "plastic_mold", rate: 60 }
                ]
            },
            {
                name: "Quantum Signal Relay (Copper Filaments)",
                building: "manufacturer",
                inputs: [
                    { item: "plastic_mold", rate: 120 },
                    { item: "copper_filament", rate: 60 },
                    { item: "osmium_reinforcement", rate: 60 }
                ],
                outputs: [
                    { item: "quantum_signal_relay", rate: 30 }
                ]
            },
            {
                name: "Quantum Signal Relay (Steel Sheets)",
                building: "manufacturer",
                inputs: [
                    { item: "plastic_mold", rate: 120 },
                    { item: "steel_sheet", rate: 60 },
                    { item: "osmium_reinforcement", rate: 60 }
                ],
                outputs: [
                    { item: "quantum_signal_relay", rate: 30 }
                ]
            },
            
            {
                name: 'Condensed Helium-3 (Bifluxor)',
                building: 'bifluxor',
                inputs: [ { item: 'helium_3'} ],
                outputs: [ { item: 'condensed_helium_3'} ],
            },
            {
                name: 'Quantum Energy Solution (Chemical Infuser)',
                building: 'chemical_infuser',
                inputs: [ { item: 'superheated_plasma_core'}, { item: 'condensed_helium_3'} ],
                outputs: [ { item: 'quantum_energy_solution'} ],
            },
            {
                name: 'Quantum Plasma (Chemical Infuser)',
                building: 'chemical_infuser',
                inputs: [ { item: 'quantum_energy_solution'}, { item: 'chrono_catalyst_gel'} ],
                outputs: [ { item: 'quantum_plasma'} ],
            },
            {
                name: 'Uranium Ion Cell (Dissolution Chamber, Quantum)',
                building: 'dissolution_chamber',
                inputs: [ { item: 'quantum_plasma'}, { item: 'uranium', rate: 60 } ],
                outputs: [ { item: 'uranium_ion_cell', rate: 20 } ],
            },
			{
				name: 'Superluminal Relay Core (Manufacturer)',
				building: 'manufacturer',
				inputs: [
					{ item: 'pulse_energy_matrix', rate: 60 },
					{ item: 'tuned_quantum_processor', rate: 60 },
					{ item: 'quantum_signal_relay', rate: 60 }
				],
				outputs: [ { item: 'superluminal_relay_core', rate: 60 } ],
			},
			{
				name: 'Fractal Processing Prism (Welder)',
				building: 'welder',
				inputs: [
					{ item: 'superluminal_relay_core', rate: 30 },
					{ item: 'lattice_encoded_memory_bank', rate: 30 }
				],
				outputs: [ { item: 'fractal_processing_prism', rate: 30 } ],
			},
			{
				name: 'Quantum-Resonant Lens Core (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [
					{ item: 'fractal_processing_prism', rate: 60 },
					{ item: 'voidglass_focusing_array', rate: 120 }
				],
				outputs: [ { item: 'quantum_resonant_lens_core', rate: 60 } ],
			},
			{
				name: 'Galactic Essence Singularity (Welder)',
				building: 'welder',
				inputs: [
					{ item: 'fractured_singularity_mesh', rate: 60 },
					{ item: 'quantum_resonant_lens_core', rate: 60 }
				],
				outputs: [ { item: 'galactic_essence_singularity', rate: 60 } ],
			},
			{
				name: 'Chronium Crystal Core (Advanced Furnace)',
				building: 'advanced_furnace',
				inputs: [ { item: 'chronium_crystal', rate: 30 } ],
				outputs: [ { item: 'chronium_crystal_core', rate: 30 } ],
			},
			{
				name: 'Chronium Crystal Core (Furnace)',
				building: 'furnace',
				inputs: [ { item: 'chronium_crystal', rate: 15 } ],
				outputs: [ { item: 'chronium_crystal_core', rate: 15 } ],
			},
			{
				name: 'Luminary Crystal Core (Welder)',
		    	building: 'welder',
				inputs: [ { item: 'astralite_fragment', rate: 60 }, { item: 'chronium_crystal_core', rate: 30 } ],
				outputs: [ { item: 'luminary_crystal_core', rate: 30 } ],
			},
			{
				name: 'Sapphire Conduit (Welder, Alt)',
				building: 'welder',
				inputs: [ { item: 'sapphire', rate: 120 }, { item: 'luminary_crystal_core', rate: 60 } ],
				outputs: [ { item: 'sapphire_conduit', rate: 60 } ],
			},
			{
				name: 'Pulse Energy Matrix (Storage Packing)',
				building: 'storage_packing',
			    inputs: [ { item: 'sapphire_conduit', rate: 60 }, { item: 'chronium_suspension' } ],
				outputs: [ { item: 'pulse_energy_matrix', rate: 60 } ],
			},
			{
				name: 'Pulse Energy Matrix (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [ { item: 'sapphire_conduit', rate: 60 }, { item: 'ether_quartz', rate: 120 }, { item: 'chronium_suspension' } ],
				outputs: [ { item: 'pulse_energy_matrix', rate: 30 } ],
			},
			{
				name: 'Tuned Quantum Processor (Welder)',
				building: 'welder',
				inputs: [ { item: 'crystallized_diamond_core', rate: 60 }, { item: 'aluminum_coating', rate: 120 } ],
				outputs: [ { item: 'tuned_quantum_processor', rate: 60 } ],
			},
			{
				name: 'Tuned Quantum Processor (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [ { item: 'crystallized_diamond_core', rate: 60 }, { item: 'railway_line', rate: 120 } ],
				outputs: [ { item: 'tuned_quantum_processor', rate: 120 } ],
			},
			{
				name: 'Reinforced Nails (Advanced Furnace)',
				building: 'advanced_furnace',
				inputs: [ { item: 'iron_bar', rate: 60 }, { item: 'coal', rate: 60 } ],
				outputs: [ { item: 'reinforced_nails', rate: 60 } ],
			},
			{
				name: 'Railway Tracks (Manufacturer)',
				building: 'manufacturer',
				inputs: [ { item: 'iron_bar', rate: 120 }, { item: 'stone_block', rate: 60 }, { item: 'wooden_plank', rate: 120 } ],
				outputs: [ { item: 'railway_tracks', rate: 60 } ],
			},
			{
				name: 'Railway Tracks (Manufacturer, Alt)',
				building: 'manufacturer',
				inputs: [ { item: 'copper_bar', rate: 60 }, { item: 'stone', rate: 120 }, { item: 'wooden_plank', rate: 60 } ],
				outputs: [ { item: 'railway_tracks', rate: 30 } ],
			},
			{
				name: 'Railway Line (Manufacturer)',
				building: 'manufacturer',
				inputs: [ { item: 'reinforced_nails', rate: 60 }, { item: 'railway_tracks', rate: 60 }, { item: 'reinforced_concrete', rate: 60 } ],
				outputs: [ { item: 'railway_line', rate: 60 } ],
			},
			{
				name: 'Railway Line (Welder)',
				building: 'welder',
				inputs: [ { item: 'reinforced_nails', rate: 120 }, { item: 'railway_tracks', rate: 60 } ],
				outputs: [ { item: 'railway_line', rate: 120 } ],
			},
			{
				name: 'Iron Bar (Press)',
				building: 'press',
				inputs: [{ item: 'iron', rate: 60 }],
				outputs: [{ item: 'iron_bar', rate: 60 }],
			},
			{
				name: 'Iron Ingot (Furnace)',
				building: 'furnace',
				inputs: [ { item: 'iron', rate: 60 } ],
				outputs: [ { item: 'iron_ingot', rate: 60 } ],
			},
			{
				name: 'Sapphire Conduit (Welder)',
				building: 'welder',
				inputs: [
					{ item: 'sapphire', rate: 120 },
					{ item: 'structural_cable', rate: 60 }
				],
				outputs: [ { item: 'sapphire_conduit', rate: 60 } ],
			},
			{
				name: 'Silicon Diode (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [ 
                    { item: 'silicon', rate: 120 }, 
                    { item: 'light_oil' } 
                ],
				outputs: [ { item: 'silicon_diode', rate: 60 } ],
			},
			{
				name: 'Titanium Alloy Plate (Manufacturer)',
				building: 'manufacturer',
				inputs: [ 
                    { item: 'titanium', rate: 120 }, 
                    { item: 'silicon_diode', rate: 60 }, 
                    { item: 'iron_ingot', rate: 60 } 
                ],
				outputs: [ { item: 'titanium_alloy_plate', rate: 120 } ],
			},
            {
				name: 'Astralite Fragment (Cutter)',
				building: 'cutter',
				inputs: [ { item: 'astralite', rate: 120 } ],
				outputs: [ { item: 'astralite_fragment', rate: 60 } ],
			},
			{
				name: 'Astralite Fragment (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [ { item: 'astralite', rate: 60 } ],
				outputs: [ { item: 'astralite_fragment', rate: 60 } ],
			},
			{
				name: 'Astral Reinforcement Panel (Manufacturer, Astralite)',
				building: 'manufacturer',
				inputs: [ 
                    { item: 'quartz_insulated_glass', rate: 60 }, 
                    { item: 'titanium_alloy_plate', rate: 60 }, 
                    { item: 'astralite_fragment', rate: 120 } 
                ],
				outputs: [ { item: 'astral_reinforcement_panel', rate: 60 } ],
			},
			{
				name: 'Wood Board (Press)',
				building: 'press',
				inputs: [ { item: 'wood', rate: 60 } ],
				outputs: [ { item: 'wood_board', rate: 60 } ],
			},
			{
				name: 'Astral Reinforcement Panel (Manufacturer, Wood)',
				building: 'manufacturer',
				inputs: [ 
                    { item: 'quartz_insulated_glass', rate: 60 }, 
                    { item: 'titanium_alloy_plate', rate: 60 }, 
                    { item: 'wood_board', rate: 120 } 
                ],
				outputs: [ { item: 'astral_reinforcement_panel', rate: 60 } ],
			},
            {
		        name: 'Uranium Suspension (Dissolution Chamber)',
		        building: 'dissolution_chamber',
		        inputs: [ { item: 'uranium_ion_cell', rate: 20 } ],
		        outputs: [ { item: 'uranium_suspension'} ],
            },
	        {
		        name: 'Refined Uranium Rod (Storage Packing)',
		        building: 'storage_packing',
		        inputs: [ 
                    { item: 'uranium', rate: 120 }, 
                    { item: 'uranium_suspension'} 
                ],
		        outputs: [ { item: 'refined_uranium_rod', rate: 60 } ],
	        },
            {
                name: 'Refined Uranium Rod (Dissolution Chamber)',
                building: 'dissolution_chamber',
                inputs: [ 
                    { item: 'uranium', rate: 120 }, 
                    { item: 'uranium_suspension'} 
                ],
                outputs: [ { item: 'refined_uranium_rod', rate: 30 } ],
            },
            {
                name: 'Titanium Mesh (Advanced Press)',
                building: 'advanced_press',
                inputs: [ 
                    { item: 'titanium', rate: 60 }, 
                    { item: 'aluminum', rate: 60 } 
                ],
                outputs: [ { item: 'titanium_mesh', rate: 30 } ],
            },
            {
                name: 'Titanium Mesh (Advanced Furnace)',
                building: 'advanced_furnace',
                inputs: [ 
                    { item: 'titanium', rate: 120 }, 
                    { item: 'aluminum', rate: 120 } 
                ],
                outputs: [ { item: 'titanium_mesh', rate: 60 } ],
            },
            {
		        name: "Fractured Singularity Mesh (Manufacturer)",
		        building: "manufacturer",
		        inputs: [
			        { item: "singularity_infused_actuator", rate: 60 },
			        { item: "voidglass_focusing_array", rate: 120 },
			        { item: "lattice_encoded_memory_bank", rate: 60 }
		        ],
		        outputs: [
			        { item: 'fractured_singularity_mesh', rate: 60 }
		    ]
	        },
            {
                name: 'Singularity-Infused Actuator (Manufacturer)',
                building: 'manufacturer',
                inputs: [ 
                    { item: 'automated_singularity_converter', rate: 120 }, 
                    { item: 'refined_uranium_rod', rate: 60 }, 
                    { item: 'titanium_mesh', rate: 240 } 
                ],
                outputs: [ { item: 'singularity_infused_actuator', rate: 60 } ],
            },
            {
                name: 'Quartz Insulated Glass (Furnace)',
                building: 'furnace',
                inputs: [ { item: 'quartz', rate: 60 } ],
                outputs: [ { item: 'quartz_insulated_glass', rate: 30 } ],
            },
            {
                name: 'Photonic Diamond Layer (Press)',
                building: 'press',
                inputs: [ { item: 'diamond', rate: 60 } ],
                outputs: [ { item: 'photonic_diamond_layer', rate: 120 } ],
            },
			{
				name: 'Copper Pipe (Cutter)',
				building: 'cutter',
				inputs: [{ item: 'copper', rate: 60 }],
				outputs: [{ item: 'copper_pipe', rate: 120 }],
			},
			{
				name: 'Wood to Coal (Furnace)',
				building: 'furnace',
				inputs: [{ item: 'wood', rate: 60 }],
				outputs: [{ item: 'coal', rate: 60 }],
			},
			{
				name: 'Wood to Wooden Plank (Cutter)',
				building: 'cutter',
				inputs: [{ item: 'wood', rate: 60 }],
				outputs: [{ item: 'wooden_plank', rate: 60 }],
			},
			{
				name: 'Wood to Wooden Plank (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [{ item: 'wood', rate: 60 }],
				outputs: [{ item: 'wooden_plank', rate: 120 }],
			},
			{
				name: 'Wooden Plank to Coal (Furnace)',
				building: 'furnace',
				inputs: [{ item: 'wooden_plank', rate: 60 }],
				outputs: [{ item: 'coal', rate: 120 }],
			},
			{
				name: 'Steel (Welder)',
				building: 'welder',
				inputs: [
					{ item: 'coal', rate: 60 },
					{ item: 'iron', rate: 120 }
				],
				outputs: [{ item: 'steel', rate: 60 }],
			},
			{
				name: 'Steel (Advanced Furnace)',
				building: 'advanced_furnace',
				inputs: [
					{ item: 'coal', rate: 60 },
					{ item: 'iron', rate: 60 }
				],
				outputs: [{ item: 'steel', rate: 120 }],
			},
			{
				name: 'Steel Sheet (Cutter)',
				building: 'cutter',
				inputs: [{ item: 'steel', rate: 60 }],
				outputs: [{ item: 'steel_sheet', rate: 120 }],
			},
			{
				name: 'Quantum Core Singularity (Manufacturer)',
				building: 'manufacturer',
				inputs: [
					{ item: 'copper_pipe', rate: 60 },
					{ item: 'steel_sheet', rate: 60 }
				],
				outputs: [{ item: 'quantum_core_singularity', rate: 60 }],
			},
			{
				name: 'Copper Filament (Furnace)',
				building: 'furnace',
				inputs: [{ item: 'copper', rate: 60 }],
				outputs: [{ item: 'copper_filament', rate: 120 }],
			},
			{
				name: 'Reinforced Steel Plate (Furnace)',
				building: 'furnace',
				inputs: [{ item: 'steel', rate: 60 }],
				outputs: [{ item: 'reinforced_steel_plate', rate: 60 }],
			},
			{
				name: 'Structural Cable (Welder)',
				building: 'welder',
				inputs: [
					{ item: 'copper_filament', rate: 120 },
					{ item: 'reinforced_steel_plate', rate: 60 }
				],
				outputs: [{ item: 'structural_cable', rate: 60 }],
			},
			{
				name: 'Copper Bar (Press)',
				building: 'press',
				inputs: [{ item: 'copper', rate: 60 }],
				outputs: [{ item: 'copper_bar', rate: 60 }],
			},
			{
				name: 'Structural Cable (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [
					{ item: 'copper_filament', rate: 120 },
					{ item: 'copper_bar', rate: 60 }
				],
				outputs: [{ item: 'structural_cable', rate: 60 }],
			},
			{
				name: 'Power Cable (Furnace)',
				building: 'furnace',
				inputs: [{ item: 'structural_cable', rate: 30 }],
				outputs: [{ item: 'power_cable', rate: 30 }],
			},
			{
				name: 'Power Cable (Advanced Press)',
				building: 'advanced_press',
				inputs: [{ item: 'structural_cable', rate: 60 }],
				outputs: [{ item: 'power_cable', rate: 60 }],
			},
			{
				name: 'Stellar Nexus Singularity (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [
					{ item: 'power_cable', rate: 120 },
					{ item: 'quantum_core_singularity', rate: 120 }
				],
				outputs: [{ item: 'stellar_nexus_singularity', rate: 120 }],
			},
			{
				name: 'Stone Block (Cutter)',
				building: 'cutter',
				inputs: [{ item: 'stone', rate: 60 }],
				outputs: [{ item: 'stone_block', rate: 60 }],
			},
			{
				name: 'Support Beam (Advanced Press)',
				building: 'advanced_press',
				inputs: [
					{ item: 'iron_pipe', rate: 60 },
					{ item: 'stone_block', rate: 60 }
				],
				outputs: [{ item: 'support_beam', rate: 60 }],
			},
			{
				name: 'Support Beam (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [
					{ item: 'copper_pipe', rate: 120 },
					{ item: 'stone_block', rate: 120 }
				],
				outputs: [{ item: 'support_beam', rate: 120 }],
			},
			{
				name: 'Stellar Nexus Singularity (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [
					{ item: 'support_beam', rate: 120 },
					{ item: 'quantum_core_singularity', rate: 120 }
				],
				outputs: [{ item: 'stellar_nexus_singularity', rate: 60 }],
			},
			{
				name: 'Iron Pipe (Cutter)',
				building: 'cutter',
				inputs: [{ item: 'iron', rate: 60 }],
				outputs: [{ item: 'iron_pipe', rate: 120 }],
			},
			{
				name: 'Liquid Chloride (Bifluxor)',
				building: 'bifluxor',
				inputs: [{ item: 'chloride' }],
				outputs: [{ item: 'liquid_chloride' }],
			},
			{
				name: 'Aluminum Coating (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [
					{ item: 'aluminum_ingot', rate: 60 },
					{ item: 'aluminum_bar', rate: 60 },
					{ item: 'liquid_chloride' }
				],
				outputs: [{ item: 'aluminum_coating', rate: 60 }],
			},
			{
				name: 'Advanced Solar Module (Manufacturer)',
				building: 'manufacturer',
				inputs: [
					{ item: 'solar_cell', rate: 60 },
					{ item: 'aluminum_frame', rate: 60 },
					{ item: 'aluminum_coating', rate: 120 }
				],
				outputs: [{ item: 'advanced_solar_module', rate: 60 }],
			},
			{
				name: 'Automated Singularity Converter (Manufacturer)',
				building: 'manufacturer',
				inputs: [
					{ item: 'advanced_solar_module', rate: 60 },
					{ item: 'sapphire_energy_cell', rate: 60 },
					{ item: 'cosmic_singularity', rate: 60 }
				],
				outputs: [{ item: 'automated_singularity_converter', rate: 60 }],
			},
			{
				name: 'Sapphire Energy Cell (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [
					{ item: 'sapphire', rate: 60 },
					{ item: 'refined_ether_quartz', rate: 60 }
				],
				outputs: [{ item: 'sapphire_energy_cell', rate: 30 }],
			},
			{
				name: 'Polycrystalline Silicon (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [
					{ item: 'silicon', rate: 120 },
					{ item: 'liquid_deuterium' }
				],
				outputs: [{ item: 'polycrystalline_silicon', rate: 60 }],
			},
			{
				name: 'Heavy Oil & Light Oil (Distilation Column)',
				building: 'distilation_column',
				inputs: [{ item: 'oil' }],
				outputs: [
					{ item: 'heavy_oil' },
					{ item: 'light_oil' }
				],
			},
			{
				name: 'Polycrystalline Silicon (Dissolution Chamber, Alt)',
				building: 'dissolution_chamber',
				inputs: [
					{ item: 'silicon', rate: 120 },
					{ item: 'heavy_oil' }
				],
				outputs: [{ item: 'polycrystalline_silicon', rate: 60 }],
			},
			{
				name: 'Solar Cell (Manufacturer)',
				building: 'manufacturer',
				inputs: [
					{ item: 'polycrystalline_silicon', rate: 60 },
					{ item: 'aluminum_ingot', rate: 120 },
					{ item: 'aluminum_bar', rate: 60 }
				],
				outputs: [{ item: 'solar_cell', rate: 60 }],
			},
			{
				name: 'Solar Cell (Welder)',
				building: 'welder',
				inputs: [
					{ item: 'polycrystalline_silicon', rate: 60 },
					{ item: 'aluminum_profile', rate: 120 }
				],
				outputs: [{ item: 'solar_cell', rate: 60 }],
			},
			{
				name: 'Refined Ether Quartz (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [
					{ item: 'ether_quartz', rate: 60 },
					{ item: 'liquid_oxygen' }
				],
				outputs: [{ item: 'refined_ether_quartz', rate: 60 }],
			},
			{
				name: 'Liquid Nitrogen (Bifluxor)',
				building: 'bifluxor',
				inputs: [{ item: 'nitrogen' }],
				outputs: [{ item: 'liquid_nitrogen' }],
			},
			{
				name: 'Refined Ether Quartz (Dissolution Chamber, Alt 1)',
				building: 'dissolution_chamber',
				inputs: [
					{ item: 'ether_quartz', rate: 60 },
					{ item: 'liquid_nitrogen' }
				],
				outputs: [{ item: 'refined_ether_quartz', rate: 60 }],
			},
			{
				name: 'Brine (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [
					{ item: 'salt', rate: 60 },
					{ item: 'water' }
				],
				outputs: [{ item: 'brine' }],
			},
			{
				name: 'Sodium & Chloride (Bifluxor)',
				building: 'bifluxor',
				inputs: [{ item: 'brine' }],
				outputs: [
					{ item: 'sodium' },
					{ item: 'chloride' }
				],
			},
			{
				name: 'Refined Ether Quartz (Dissolution Chamber, Alt 2)',
				building: 'dissolution_chamber',
				inputs: [
					{ item: 'ether_quartz', rate: 60 },
					{ item: 'sodium' }
				],
				outputs: [{ item: 'refined_ether_quartz', rate: 60 }],
			},
			{
				name: 'Aluminum Ingot (Furnace)',
				building: 'furnace',
				inputs: [{ item: 'aluminum', rate: 60 }],
				outputs: [{ item: 'aluminum_ingot', rate: 60 }],
			},
			{
				name: 'Aluminum Bar (Press)',
				building: 'press',
				inputs: [{ item: 'aluminum', rate: 60 }],
				outputs: [{ item: 'aluminum_bar', rate: 120 }],
			},
			{
				name: 'Aluminum Profile (Cutter)',
				building: 'cutter',
				inputs: [{ item: 'aluminum', rate: 120 }],
				outputs: [{ item: 'aluminum_profile', rate: 60 }],
			},
			{
				name: 'Aluminum Profile (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [{ item: 'aluminum', rate: 60 }],
				outputs: [{ item: 'aluminum_profile', rate: 60 }],
			},
			{
				name: 'Aluminum Frame (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [
					{ item: 'aluminum_profile', rate: 60 },
					{ item: 'aluminum_bar', rate: 30 },
					{ item: 'sulfuric_acid' }
				],
				outputs: [{ item: 'aluminum_frame', rate: 30 }],
			},
			{
				name: 'Aluminum Frame (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [
					{ item: 'aluminum_profile', rate: 120 },
					{ item: 'aluminum_bar', rate: 120 }
				],
				outputs: [{ item: 'aluminum_frame', rate: 60 }],
			},
			{
				name: 'Aluminum Coating (Welder)',
				building: 'welder',
				inputs: [
					{ item: 'aluminum_ingot', rate: 30 },
					{ item: 'aluminum_bar', rate: 30 }
				],
				outputs: [{ item: 'aluminum_coating', rate: 30 }],
			},
			{
				name: 'Liquid Oxygen (Bifluxor)',
				building: 'bifluxor',
				inputs: [{ item: 'oxygen' }],
				outputs: [{ item: 'liquid_oxygen' }],
			},
			{
				name: 'Deuterium (Bifluxor)',
				building: 'bifluxor',
				inputs: [{ item: 'heavy_water' }],
				outputs: [{ item: 'deuterium' }],
			},
			{
				name: 'Liquid Deuterium (Bifluxor)',
				building: 'bifluxor',
				inputs: [{ item: 'deuterium' }],
				outputs: [{ item: 'liquid_deuterium' }],
			},
			{
				name: 'Sulfur Dioxide (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [{ item: 'sulfur', rate: 60 }],
				outputs: [{ item: 'sulfur_dioxide' }],
			},
			{
				name: 'Water Steam (Chemical Infuser)',
				building: 'chemical_infuser',
				inputs: [{ item: 'water' }],
				outputs: [{ item: 'water_steam' }],
			},
			{
				name: 'Sulfur Trioxide (Chemical Infuser)',
				building: 'chemical_infuser',
				inputs: [
					{ item: 'sulfur_dioxide' },
					{ item: 'water_steam' }
				],
				outputs: [{ item: 'sulfur_trioxide' }],
			},
			{
				name: 'Sulfuric Acid (Chemical Infuser)',
				building: 'chemical_infuser',
				inputs: [
					{ item: 'sulfur_trioxide' },
					{ item: 'water_steam' }
				],
				outputs: [{ item: 'sulfuric_acid' }],
			},
			{
				name: 'LV Transformer (Manufacturer)',
				building: 'manufacturer',
				inputs: [
					{ item: 'power_cable', rate: 120 },
					{ item: 'steel_sheet', rate: 120 },
					{ item: 'reinforced_steel_plate', rate: 60 }
				],
				outputs: [{ item: 'lv_transformer', rate: 60 }],
			},
			{
				name: 'HV Transformer (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [
					{ item: 'lv_transformer', rate: 60 },
					{ item: 'copper_bar', rate: 120 }
				],
				outputs: [{ item: 'hv_transformer', rate: 60 }],
			},
			{
				name: 'HV Transformer (Advanced Cutter, Alt)',
				building: 'advanced_cutter',
				inputs: [
					{ item: 'lv_transformer', rate: 30 },
					{ item: 'iron_pipe', rate: 120 }
				],
				outputs: [{ item: 'hv_transformer', rate: 30 }],
			},
			{
				name: 'Cosmic Singularity (Manufacturer)',
				building: 'manufacturer',
				inputs: [
					{ item: 'hv_transformer', rate: 60 },
					{ item: 'stellar_nexus_singularity', rate: 60 }
				],
				outputs: [{ item: 'cosmic_singularity', rate: 60 }],
			},
			{
				name: 'Cosmic Singularity (Manufacturer, Alt)',
				building: 'manufacturer',
				inputs: [
					{ item: 'lv_transformer', rate: 120 },
					{ item: 'stellar_nexus_singularity', rate: 60 }
				],
				outputs: [{ item: 'cosmic_singularity', rate: 60 }],
			},
			{
				name: 'Hydrogen & Oxygen (Bifluxor)',
				building: 'bifluxor',
				inputs: [{ item: 'water' }],
				outputs: [
					{ item: 'hydrogen' },
					{ item: 'oxygen' }
				]
			},
			{
				name: 'Ionized Hydrogen (Chemical Infuser)',
				building: 'chemical_infuser',
				inputs: [{ item: 'hydrogen' }],
				outputs: [{ item: 'ionized_hydrogen' }]
			},
			{
				name: 'Plasma Arc Energy (Bifluxor)',
				building: 'bifluxor',
				inputs: [{ item: 'ionized_hydrogen' }],
				outputs: [{ item: 'plasma_arc_energy' }]
			},
			{
				name: 'Superheated Plasma Core (Chemical Infuser)',
				building: 'chemical_infuser',
				inputs: [{ item: 'plasma_arc_energy' }],
				outputs: [{ item: 'superheated_plasma_core' }]
			},
			{
				name: 'Uranium Ion Cell (Storage Packing)',
				building: 'storage_packing',
				inputs: [
					{ item: 'uranium', rate: 60 },
					{ item: 'superheated_plasma_core' }
				],
				outputs: [
					{ item: 'uranium_ion_cell', rate: 10 }
				]
			},
			{
				name: 'Liquid Hydrogen (Bifluxor)',
				building: 'bifluxor',
				inputs: [ { item: 'hydrogen' } ],
				outputs: [ { item: 'liquid_hydrogen' } ],
			},
			{
				name: 'Substrate & Ethylene (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [ { item: 'water' }, { item: 'liquid_hydrogen' }, { item: 'biomass', rate: 60 } ],
				outputs: [ { item: 'substrate', rate: 60 }, { item: 'ethylene' } ],
			},
			{
				name: 'Etheric Binder Gel (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [ { item: 'substrate', rate: 60 } ],
				outputs: [ { item: 'etheric_binder_gel' } ],
			},
			{
				name: 'Reinforced Uranium Suspension (Chemical Infuser)',
				building: 'chemical_infuser',
				inputs: [ { item: 'uranium_suspension' }, { item: 'etheric_binder_gel' } ],
				outputs: [ { item: 'reinforced_uranium_suspension' } ],
			},
			{
				name: 'Voidglass Focusing Array (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [ { item: 'astral_reinforcement_panel', rate: 60 }, { item: 'refined_uranium_rod', rate: 60 }, { item: 'uranium_ion_cell', rate: 60 }, { item: 'reinforced_uranium_suspension' } ],
				outputs: [ { item: 'voidglass_focusing_array', rate: 120 } ],
			},
			{
				name: 'Voidglass Focusing Array (Dissolution Chamber, Alt)',
				building: 'dissolution_chamber',
				inputs: [ { item: 'astral_reinforcement_panel', rate: 60 }, { item: 'refined_uranium_rod', rate: 60 }, { item: 'photonic_memory_core', rate: 60 } ],
				outputs: [ { item: 'voidglass_focusing_array', rate: 60 } ],
			},
			{
				name: 'Iridium-Plated Cable (Manufacturer)',
				building: 'manufacturer',
				inputs: [ { item: 'iridium', rate: 60 }, { item: 'power_cable', rate: 30 } ],
				outputs: [ { item: 'iridium_plated_cable', rate: 30 } ],
			},
			{
				name: 'Iridium-Plated Cable (Manufacturer, Alt)',
				building: 'manufacturer',
				inputs: [ { item: 'iridium', rate: 60 }, { item: 'structural_cable', rate: 120 } ],
				outputs: [ { item: 'iridium_plated_cable', rate: 120 } ],
			},
			{
				name: 'Diamond Dust (Cutter)',
				building: 'cutter',
				inputs: [ { item: 'diamond', rate: 120 } ],
				outputs: [ { item: 'diamond_dust', rate: 30 } ],
			},
			{
				name: 'Diamond Dust (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [ { item: 'diamond', rate: 120 } ],
				outputs: [ { item: 'diamond_dust', rate: 60 } ],
			},
			{
				name: 'Titanium Lattice (Welder)',
				building: 'welder',
				inputs: [ { item: 'titanium', rate: 30 }, { item: 'diamond_dust', rate: 30 } ],
				outputs: [ { item: 'titanium_lattice', rate: 60 } ],
			},
			{
				name: 'Crystallized Diamond Core (Furnace)',
				building: 'furnace',
				inputs: [ { item: 'diamond', rate: 60 } ],
				outputs: [ { item: 'crystallized_diamond_core', rate: 30 } ],
			},
			{
				name: 'Titanium Lattice (Welder, Alt)',
				building: 'welder',
				inputs: [ { item: 'titanium', rate: 30 }, { item: 'crystallized_diamond_core', rate: 30 } ],
				outputs: [ { item: 'titanium_lattice', rate: 120 } ],
			},
			{
				name: 'Lattice Reinforced Conduit (Welder)',
				building: 'welder',
				inputs: [ { item: 'iridium_plated_cable', rate: 60 }, { item: 'titanium_lattice', rate: 60 } ],
				outputs: [ { item: 'lattice_reinforced_conduit', rate: 60 } ],
			},
			{
				name: 'Lattice Encoded Memory Bank (Advanced Press)',
				building: 'advanced_press',
				inputs: [ { item: 'lattice_reinforced_conduit', rate: 120 }, { item: 'photonic_diamond_layer', rate: 60 } ],
				outputs: [ { item: 'lattice_encoded_memory_bank', rate: 60} ],
			},
            {
				name: 'Photonic Memory Core (Welder)',
				building: 'welder',
				inputs: [ { item: 'photonic_diamond_layer', rate: 30 }, { item: 'chronium_crystal', rate: 15 } ],
				outputs: [ { item: 'photonic_memory_core', rate: 15 } ],
			},
			{
				name: 'Diamond Slurry (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [ { item: 'diamond', rate: 60 } ],
				outputs: [ { item: 'diamond_slurry' } ],
			},
			{
				name: 'Chronium Suspension (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [ { item: 'chronium_crystal', rate: 60 } ],
				outputs: [ { item: 'chronium_suspension' } ],
			},
			{
				name: 'Iridium Solution (Dissolution Chamber)',
				building: 'dissolution_chamber',
				inputs: [ { item: 'iridium', rate: 60 } ],
				outputs: [ { item: 'iridium_solution' } ],
			},
			{
				name: 'Temporal Circuit Slurry (Chemical Infuser)',
				building: 'chemical_infuser',
				inputs: [ { item: 'diamond_slurry' }, { item: 'chronium_suspension' } ],
				outputs: [ { item: 'temporal_circuit_slurry' } ],
			},
			{
				name: 'Stabilized Iridium Matrix (Distilation Column)',
				building: 'distilation_column',
				inputs: [ { item: 'iridium_solution' } ],
				outputs: [ { item: 'stabilized_iridium_matrix' } ],
			},
			{
				name: 'Chrono Catalyst Gel (Chemical Infuser)',
				building: 'chemical_infuser',
				inputs: [ { item: 'stabilized_iridium_matrix' }, { item: 'temporal_circuit_slurry' } ],
				outputs: [ { item: 'chrono_catalyst_gel' } ],
			},
			{
				name: 'Photonic Memory Core (Storage Packing)',
				building: 'storage_packing',
				inputs: [ { item: 'photonic_diamond_layer', rate: 120 }, { item: 'chrono_catalyst_gel' } ],
				outputs: [ { item: 'photonic_memory_core', rate: 60 } ],
			},
			{
				name: 'Ruby Lens (Advanced Cutter)',
				building: 'advanced_cutter',
				inputs: [ { item: 'ruby', rate: 60 } ],
				outputs: [ { item: 'ruby_lens', rate: 30 } ],
			},
			{
				name: 'Ruby Lens (Cutter)',
				building: 'cutter',
				inputs: [ { item: 'ruby', rate: 120 } ],
				outputs: [ { item: 'ruby_lens', rate: 30 } ],
			},
			{
				name: 'Tri-Crystal Fusion Node (Manufacturer)',
				building: 'manufacturer',
				inputs: [ { item: 'refined_ether_quartz', rate: 120 }, { item: 'sapphire_energy_cell', rate: 60 }, { item: 'ruby_lens', rate: 120 } ],
				outputs: [ { item: 'tri_crystal_fusion_node', rate: 60 } ],
			},
			{
				name: 'Quantum Data Compressor (Advanced Cutter, Alt)',
				building: 'advanced_cutter',
				inputs: [ { item: 'tri_crystal_fusion_node', rate: 60 }, { item: 'phase_synced_relay_circuit', rate: 60 } ],
				outputs: [ { item: 'quantum_data_compressor', rate: 120 } ],
			},
			{
				name: 'Phase-Synced Relay Circuit (advanced furnace)',
				building: 'advanced_furnace',
				inputs: [ { item: 'ruby_circuit_inlay', rate: 120 }, { item: 'polycrystalline_silicon', rate: 240 } ],
				outputs: [ { item: 'osmium_reinforcement', rate: 240 } ],
			},
			{
				name: 'Phase-Synced Relay Circuit (advanced furnace)',
				building: 'advanced_furnace',
				inputs: [ { item: 'ruby', rate: 60 }],
				outputs: [ { item: 'ruby_circuit_inlay', rate: 60 } ],
			},
		
		];

		// Populate custom item dropdown (icon + label). The real value is stored in the hidden input (#item-select)
		const itemSelect = document.getElementById('item-select'); // hidden input to preserve existing code
		const rateInput = document.getElementById('rate-input');
		const itemSelectOptions = document.getElementById('item-select-options');
		const itemSelectToggle = document.getElementById('item-select-toggle');
		const itemSelectLabel = document.getElementById('item-select-label');
		const itemSelectIcon = document.getElementById('item-select-icon');
		const itemSelectContainer = document.getElementById('item-select-container');

		// Build option rows
		Object.entries(items).forEach(([key, item]) => {
			const row = document.createElement('div');
			row.className = 'item-option';
			row.style.display = 'flex';
			row.style.alignItems = 'center';
			row.style.gap = '0.5rem';
			row.style.padding = '6px';
			row.style.borderRadius = '6px';
			row.style.cursor = 'pointer';
			row.dataset.key = key;

			const img = document.createElement('img');
			img.src = item.icon ? (item.icon) : '';
			img.alt = item.name || key;
			img.style.width = '28px';
			img.style.height = '28px';
			img.style.objectFit = 'contain';
			img.style.borderRadius = '4px';

			const span = document.createElement('span');
			span.textContent = item.name || key;
			span.style.flex = '1';

			row.appendChild(img);
			row.appendChild(span);

			row.addEventListener('click', () => {
				// Set hidden input value and update visible label/icon
				itemSelect.value = key;
				itemSelectLabel.textContent = item.name || key;
				if (item.icon) {
					itemSelectIcon.src = 'Icons/Automate It Icons/' + item.icon;
					itemSelectIcon.style.display = 'inline-block';
				} else {
					itemSelectIcon.style.display = 'none';
				}
				// Trigger change so existing listeners (rate disabling, etc.) run
				itemSelect.dispatchEvent(new Event('change'));
				// Hide options
				itemSelectOptions.style.display = 'none';
			});

			// Hover effect
			row.addEventListener('mouseenter', () => { row.style.background = '#2b2f33'; });
			row.addEventListener('mouseleave', () => { row.style.background = 'transparent'; });

			itemSelectOptions.appendChild(row);
		});

		// Toggle dropdown visibility
		itemSelectToggle.addEventListener('click', (e) => {
			e.stopPropagation();
			itemSelectOptions.style.display = itemSelectOptions.style.display === 'block' ? 'none' : 'block';
		});

		// Close dropdown when clicking outside
		document.addEventListener('click', (e) => {
			if (!itemSelectContainer.contains(e.target)) {
				itemSelectOptions.style.display = 'none';
			}
		});

				// Modal logic for available items
						let availableItemsList = [];
						// Load from localStorage if present
						try {
							const saved = localStorage.getItem('availableItemsList');
							if (saved) {
								availableItemsList = JSON.parse(saved);
							}
						} catch(e) {}
				const modal = document.getElementById('available-items-modal');
				const openModalBtn = document.getElementById('edit-available-items-btn');
				const closeModalBtn = document.getElementById('close-available-items-modal');
				const addRowBtn = document.getElementById('add-available-item-row');
				const tableBody = document.querySelector('#available-items-table tbody');
				const form = document.getElementById('available-items-form');

				function renderAvailableItemsTable() {
					// Combine duplicate items (solids only, sum amounts)
					const combined = [];
					for (const row of availableItemsList) {
						const type = items[row.item]?.type;
						if (type === 'nonsolid') {
							if (!combined.some(r => r.item === row.item)) {
								combined.push({ item: row.item });
							}
						} else {
							const existing = combined.find(r => r.item === row.item);
							if (existing) {
								existing.amount = (existing.amount || 0) + (row.amount || 0);
							} else {
								combined.push({ item: row.item, amount: row.amount });
							}
						}
					}
					// Replace availableItemsList with combined
					availableItemsList = combined;
					tableBody.innerHTML = '';
					availableItemsList.forEach((row, idx) => {
						const type = items[row.item]?.type;
						const tr = document.createElement('tr');
						tr.innerHTML = `
							<td><select><option value=""${!row.item?' selected':''}>Select item</option>${Object.entries(items).map(([k, i]) => `<option value="${k}"${row.item===k?' selected':''}>${i.name}</option>`).join('')}</select></td>
							<td>${type === 'nonsolid' ? '<span style="color:#888;">N/A</span>' : `<input type="number" min="0" step="1" value="${row.amount ?? ''}" style="width:80px;">`}</td>
							<td><button type="button" data-row="${idx}" class="remove-available-item-row">Remove</button></td>
						`;
						tableBody.appendChild(tr);
					});
				}

						openModalBtn.addEventListener('click', () => {
							if (availableItemsList.length === 0) {
								availableItemsList.push({ item: Object.keys(items)[0], amount: 1 });
							}
							renderAvailableItemsTable();
							modal.style.display = 'flex';
						});
				closeModalBtn.addEventListener('click', () => {
					modal.style.display = 'none';
				});
				addRowBtn.addEventListener('click', () => {
					// Add a new row with no item selected (forces 'Select item' in the dropdown)
					availableItemsList.push({ item: '', amount: 1 });
					renderAvailableItemsTable();
				});
				tableBody.addEventListener('click', (e) => {
					if (e.target.classList.contains('remove-available-item-row')) {
						const idx = parseInt(e.target.getAttribute('data-row'));
						availableItemsList.splice(idx, 1);
						renderAvailableItemsTable();
					}
				});
				tableBody.addEventListener('change', (e) => {
					const tr = e.target.closest('tr');
					const idx = Array.from(tableBody.children).indexOf(tr);
					if (e.target.tagName === 'SELECT') {
						availableItemsList[idx].item = e.target.value;
						// If new item is nonsolid, clear amount
						if (items[e.target.value]?.type === 'nonsolid') {
							availableItemsList[idx].amount = null;
						}
						renderAvailableItemsTable();
					} else if (e.target.tagName === 'INPUT') {
						// Only allow input for solids
						if (items[availableItemsList[idx].item]?.type !== 'nonsolid') {
							availableItemsList[idx].amount = parseInt(e.target.value) || 0;
						}
					}
				});
						form.addEventListener('submit', (e) => {
							e.preventDefault();
					// Save to localStorage, but remove amount for nonsolids
							try {
								const filtered = availableItemsList.map(row => {
									const type = items[row.item]?.type;
							return type === 'nonsolid' ? { item: row.item } : row;
								});
								localStorage.setItem('availableItemsList', JSON.stringify(filtered));
							} catch(e) {}
							modal.style.display = 'none';
						});

		// Disable rate input for nonsolid
		itemSelect.addEventListener('change', function() {
			const selectedType = items[this.value]?.type;
			if (selectedType === 'nonsolid') {
				rateInput.value = '';
				rateInput.disabled = true;
				rateInput.placeholder = 'No rate needed';
			} else {
				rateInput.disabled = false;
				rateInput.placeholder = 'Rate per minute';
			}
		});


		// --- Basic calculation and display logic ---
		document.getElementById('calculate-btn').addEventListener('click', () => {
			const selectedItem = itemSelect.value;
			const selectedType = items[selectedItem]?.type;
			let rate = 1;
			if (selectedType !== 'nonsolid') {
				rate = parseFloat(rateInput.value);
			}
			const planDiv = document.getElementById('production-plan');
			const optimizeBy = document.getElementById('optimize-select').value;
			// Get available items and amounts from modal
			const availableItems = availableItemsList.map(row => row.item);
			const availableAmounts = {};
			availableItemsList.forEach(row => { availableAmounts[row.item] = row.amount; });
			if (!selectedItem || (selectedType !== 'nonsolid' && (isNaN(rate) || rate <= 0))) {
				planDiv.innerHTML = '<div class="placeholder-graph">Please select an item and enter a valid rate.</div>';
				return;
			}
			// For nonsolid, set rate to 1 (arbitrary, since rate is not needed)
			if (selectedType === 'nonsolid') {
				rate = 1;
			}

			// Helper: get all recipes for an item
			function getRecipesForItem(itemKey) {
				return recipes.filter(r => r.outputs.some(o => o.item === itemKey));
			}


			// Helper: combinatorial optimizer for recipe splitting
			// Integer building counts, pool excess for reuse
			// Brute-force optimizer: test all combinations of normal/overclocked for all recipes, select lowest metric
			function optimizeRecipes(itemKey, requiredRate, excessPool = {}) {
				const all = getRecipesForItem(itemKey);
				if (all.length === 0) return null;
				// Use excess if available
				let needed = requiredRate;
				if (excessPool[itemKey]) {
					if (excessPool[itemKey] >= needed) {
						excessPool[itemKey] -= needed;
						return [];
					} else {
						needed -= excessPool[itemKey];
						excessPool[itemKey] = 0;
					}
				}
				// Build all recipe variants (normal/overclocked)
				let variants = [];
				for (const r of all) {
					const output = r.outputs.find(o => o.item === itemKey);
					const outRate = output && output.rate ? output.rate : 1;
					// Check if all outputs are nonsolid
					const onlyNonsolid = r.outputs.every(o => {
						const t = items[o.item]?.type;
						return t === 'nonsolid';
					});
					variants.push({ recipe: r, outRate, overclocked: false });
					// Prevent overclocking if not enough available items for any input
					let canOverclock = true;
					if (!onlyNonsolid) {
						if (typeof availableAmounts !== 'undefined') {
							for (const input of r.inputs) {
								const inputType = items[input.item]?.type;
								if (inputType !== 'nonsolid' && typeof availableAmounts[input.item] === 'number') {
									// Overclocked input rate is doubled
									const required = (input.rate ?? 1) * 2;
									if (availableAmounts[input.item] < required) {
										canOverclock = false;
										break;
									}
								}
							}
						}
						if (canOverclock) {
							variants.push({ recipe: r, outRate: outRate * 2, overclocked: true });
						}
					}
				}
				// Try all combinations of building counts for each variant (integer, sum >= needed)
				// For N variants, try all combinations of building counts up to a reasonable max
				const maxBuildings = 8; // limit for performance
				let bestPlan = null;
				let bestValue = Infinity;
				let comboCount = 0;
				function* combos(n, total) {
					if (n === 1) {
						yield [total];
						return;
					}
					for (let i = 0; i <= total; ++i) {
						for (const rest of combos(n - 1, total - i)) {
							yield [i, ...rest];
						}
					}
				}
				// Try all combinations of building counts (up to maxBuildings)
				for (let totalBuildings = 1; totalBuildings <= maxBuildings; ++totalBuildings) {
					for (const counts of combos(variants.length, totalBuildings)) {
						comboCount++;
						let produced = 0;
						let plan = [];
						let totalPower = 0, totalSpace = 0, totalBld = 0;
						for (let i = 0; i < variants.length; ++i) {
							if (counts[i] === 0) continue;
							const v = variants[i];
							produced += v.outRate * counts[i];
							const building = buildings[v.recipe.building];
							let space = building.space * counts[i];
							plan.push({ recipe: v.recipe, amount: v.outRate * counts[i], used: 0, overclocked: v.overclocked, buildingCount: counts[i] });
							totalSpace += space;
							totalBld += counts[i];
						}
						if (produced < needed) continue;
						// Assign 'used' for each plan entry
						let remaining = needed;
						for (let p of plan) {
							if (remaining > 0) {
								const use = Math.min(p.amount, remaining);
								p.used = use;
								remaining -= use;
							} else {
								p.used = 0;
							}
						}
						// Compute power based on only the used portion of each building
						for (let p of plan) {
							if (p.used > 0) {
								const building = buildings[p.recipe.building];
								let buildingPower = building.power;
								if (p.overclocked) buildingPower *= 2.5;
								let fraction = p.used / p.amount;
								totalPower += buildingPower * p.buildingCount * fraction;
							}
						}
						// Compute value for metric
						let value = 0;
						if (optimizeBy === 'space') value = totalSpace;
						else if (optimizeBy === 'power') value = totalPower;
						else if (optimizeBy === 'buildings') value = totalBld;

						// Tie-breaking rules (in order):
						// 1) Lower metric value wins
						// 2) If equal, fewer total buildings wins
						// 3) If still equal, fewer overclocked buildings wins (prefer normal operation when possible)
						const candidateBuildings = totalBld;
						const bestBuildings = bestPlan ? bestPlan.reduce((s, p) => s + p.buildingCount, 0) : Infinity;
						const candidateOverclocked = plan.reduce((s, p) => s + (p.overclocked ? p.buildingCount : 0), 0);
						const bestOverclocked = bestPlan ? bestPlan.reduce((s, p) => s + (p.overclocked ? p.buildingCount : 0), 0) : Infinity;

						const isBetter = (
							value < bestValue ||
							(value === bestValue && (
								candidateBuildings < bestBuildings ||
								(candidateBuildings === bestBuildings && candidateOverclocked < bestOverclocked)
							))
						);
						if (isBetter) {
							bestValue = value;
							bestPlan = plan.map(p => ({ ...p }));
						}
					}
				}
				// Pool excess
				if (bestPlan) {
					let produced = bestPlan.reduce((sum, p) => sum + p.amount, 0);
					if (produced > needed) {
						excessPool[itemKey] = (excessPool[itemKey] || 0) + (produced - needed);
					}
					return bestPlan;
				}
				return null;
			}

			// Recursive function to build input tree
			function buildInputTree(itemKey, requiredRate, depth = 0, totals = { power: 0, space: 0, buildings: 0 }, producedNonsolids = {}, excessPool = {}, requirements = {}, fullRequirements = {}) {
				const item = items[itemKey];
				if (!item) {
					console.log(`Unknown item: ${itemKey}`);
					return `<li style='color:#f55;'>Unknown item: <b>${itemKey}</b></li>`;
				}
				const plans = optimizeRecipes(itemKey, requiredRate, excessPool);
				if (!plans) {
					// Only fail if not available and not producible (no recipe)
					if (availableItems.length && !availableItems.includes(itemKey) && getRecipesForItem(itemKey).length === 0) {
						console.log(`Cannot make ${item.name}: not in available items and no recipe.`);
						return `<li style='color:#f55;'>${requiredRate ? requiredRate.toFixed(2) + ' ' : ''}<b>${item.name}</b> (not available and no recipe)</li>`;
					}
					if (typeof availableAmounts[itemKey] !== 'undefined' && requiredRate > availableAmounts[itemKey]) {
						console.log(`Cannot make ${item.name}: need ${requiredRate}, have ${availableAmounts[itemKey]}`);
						return `<li style='color:#f55;'>${requiredRate.toFixed(2)} <b>${item.name}</b> (need ${requiredRate}, have ${availableAmounts[itemKey]})</li>`;
					}
					return `<li>${requiredRate ? requiredRate.toFixed(2) + ' ' : ''}<b>${item.name}</b>${depth === 0 ? ' per minute' : ''}</li>`;
				}
				let html = `<li>`;
				html += `${requiredRate ? requiredRate.toFixed(2) + ' ' : ''}<b>${item.name}</b>${depth === 0 ? ' per minute' : ''}`;
				html += `<ul style=\"margin:0.5rem 0 0 1.5rem;\">`;
				   plans.forEach((plan, i) => {
					   const recipe = plan.recipe;
					   const amount = plan.amount;
					   const used = plan.used;
					   const output = recipe.outputs.find(o => o.item === itemKey);
					   let outRate = output && output.rate ? output.rate : 1;
					   let building = buildings[recipe.building];
					   // Overclocking: handled by optimizer, so plan.overclocked is set if used
					   let isOverclocked = plan.overclocked || false;
					   if (isOverclocked) outRate *= 2;
					   const buildingCount = amount && outRate ? (amount / outRate) : 1;
					   let totalPower = building ? building.power * buildingCount : 0;
					   if (isOverclocked && building) totalPower *= 2.5;
					   const totalSpace = building ? building.space * buildingCount : 0;
					   if (building) {
						   totals.power += totalPower;
						   totals.space += totalSpace;
						   totals.buildings += buildingCount;
					   }
					   html += `<li><b>${buildingCount}</b> x <span>${building ? building.name : 'Unknown Building'}</span> &mdash; <span>Power: <b>${totalPower.toFixed(2)}</b></span>, <span>Space: <b>${totalSpace.toFixed(2)}</b></span> <span style='color:#aaa'>(via ${recipe.name}${plans.length > 1 ? `, ${used.toFixed(2)}/min` : ''}${amount > used ? `, ${amount.toFixed(2)}/min produced` : ''}${isOverclocked ? ', Overclocked' : ''})</span></li>`;
					   recipe.inputs.forEach(input => {
						   const inputType = items[input.item]?.type;
						   const inputHasRecipe = getRecipesForItem(input.item).length > 0;
						   let inputRate = (input.rate ?? 0) * buildingCount;
						   if (isOverclocked) inputRate *= 2;
						   // Always accumulate into full BOM (including intermediates)
						   fullRequirements[input.item] = (fullRequirements[input.item] || 0) + inputRate;
						   if (inputType === 'nonsolid') {
							   if (!producedNonsolids[input.item]) {
								   producedNonsolids[input.item] = true;
								   if (inputHasRecipe) {
									   html += buildInputTree(input.item, inputRate, depth + 1, totals, producedNonsolids, excessPool, requirements, fullRequirements);
								   } else {
									   html += `<li><b>${items[input.item].name}</b></li>`;
									   // Nonsolids without a recipe are externally supplied
									   requirements[input.item] = (requirements[input.item] || 0) + inputRate;
								   }
							   } else {
								   html += `<li><b>${items[input.item].name}</b> (already produced)</li>`;
							   }
						   } else if (inputHasRecipe) {
							   html += buildInputTree(input.item, inputRate, depth + 1, totals, producedNonsolids, excessPool, requirements, fullRequirements);
						   } else {
							   html += `<li>${inputRate.toFixed(2)} <b>${items[input.item].name}</b>${depth === 0 ? ' per minute' : ''}</li>`;
							   // Base item with no recipe: add to requirements
							   requirements[input.item] = (requirements[input.item] || 0) + inputRate;
						   }
					   });
				   });
				html += `</ul></li>`;
				return html;
			}


			// Show the full production tree for the selected item and totals
			function renderTreeAutoOverclock() {
				const totals = { power: 0, space: 0, buildings: 0 };
				const requirements = {};
				const fullRequirements = {};
				const treeHtml = buildInputTree(selectedItem, rate, 0, totals, {}, {}, requirements, fullRequirements);
				// Build a sorted Bill of Materials (base requirements)
				const reqEntries = Object.entries(requirements);
				reqEntries.sort((a, b) => items[a[0]].name.localeCompare(items[b[0]].name));
				const reqListHtml = reqEntries.length
					? `<ul style="margin:0.5rem 0 0 1.5rem;">${reqEntries.map(([key, val]) => `<li>${val.toFixed(2)} <b>${items[key]?.name || key}</b> per minute</li>`).join('')}</ul>`
					: '<div style="color:#888;">No external items required.</div>';
				// Build full Bill of Materials (including intermediates)
				const fullReqEntries = Object.entries(fullRequirements);
				fullReqEntries.sort((a, b) => items[a[0]].name.localeCompare(items[b[0]].name));
				const fullReqListHtml = fullReqEntries.length
					? `<ul style=\"margin:0.5rem 0 0 1.5rem;\">${fullReqEntries.map(([key, val]) => `<li>${val.toFixed(2)} <b>${items[key]?.name || key}</b> per minute</li>`).join('')}</ul>`
					: '<div style=\"color:#888;\">No inputs required.</div>';
				document.getElementById('plan-tree-html').innerHTML = `
					<div style="font-size:1.3rem;margin-bottom:1rem;">
						<b>${rate}</b> <span>${items[selectedItem].name}</span> per minute
					</div>
					<div style="margin-bottom:1rem;font-size:1.1rem;">
						Total Power: <b>${totals.power.toFixed(2)}</b> &nbsp; | &nbsp; Total Space: <b>${totals.space.toFixed(2)}</b> &nbsp; | &nbsp; Total Buildings: <b>${totals.buildings.toFixed(2)}</b>
					</div>
					<div style="margin-bottom:0.5rem;font-size:1.1rem;">
						<b>Required items per minute</b>
					<div style=\"margin-top:1rem;margin-bottom:0.5rem;font-size:1.1rem;\">\n                        <b>Full bill of materials (incl. intermediates)</b>\n                    </div>
					${fullReqListHtml}
					</div>
					${reqListHtml}
					<ul style="margin:0.5rem 0 0 1.5rem;">${treeHtml}</ul>
				`;
			}
			renderTreeAutoOverclock();

			// --- Network Graph Visualization ---
			function buildGraphData(itemKey, requiredRate, nodes = [], edges = [], parentId = null, nodeMap = {}, depth = 0, producedNonsolids = {}, edgeLabels = {}, edgeIndex = {}) {
				const item = items[itemKey];
				const plans = optimizeRecipes(itemKey, requiredRate);
				// Use a composite key to merge like items at the same depth
				const nodeId = itemKey + '_' + depth;
				if (!nodeMap[nodeId]) {
					let nodeObj;
					let showRate = item.type !== 'nonsolid';
					if (item.icon) {
						nodeObj = {
							id: nodeId,
							label: showRate ? `${item.name}\n${requiredRate ? requiredRate.toFixed(2) : ''}${depth === 0 ? ' /min' : ''}` : `${item.name}`,
							shape: 'image',
							image: item.icon,
							color: '#ffb347',
							font: { color: '#fff', size: 18, multi: true },
							rate: requiredRate, count: 1, parents: new Set()
						};
					} else {
						nodeObj = {
							id: nodeId,
							label: showRate ? `${item.name}\n${requiredRate ? requiredRate.toFixed(2) : ''}${depth === 0 ? ' /min' : ''}` : `${item.name}`,
							shape: 'box',
							color: '#ffb347',
							font: { color: '#fff', size: 18, multi: true },
							rate: requiredRate, count: 1, parents: new Set()
						};
					}
					nodeMap[nodeId] = nodeObj;
					nodes.push(nodeObj);
				} else {
					nodeMap[nodeId].rate += requiredRate;
					nodeMap[nodeId].count += 1;
					let showRate = item.type !== 'nonsolid';
					nodeMap[nodeId].label = showRate ? `${item.name}\n${nodeMap[nodeId].rate.toFixed(2)}${depth === 0 ? ' /min' : ''}` : `${item.name}`;
				}
				if (parentId) {
					// Only add unique edges
					if (!nodeMap[nodeId].parents.has(parentId)) {
						edges.push({ from: nodeId, to: parentId, arrows: 'to', color: '#fff', width: 2 });
						nodeMap[nodeId].parents.add(parentId);
					}
				}
				if (!plans) return { nodes, edges };
				plans.forEach((plan, i) => {
					const recipe = plan.recipe;
					const amount = plan.amount;
					const output = recipe.outputs.find(o => o.item === itemKey);
					let outRate = output && output.rate ? output.rate : 1;
					const buildingCount = amount && outRate ? (amount / outRate) : 1;
					recipe.inputs.forEach(input => {
						const inputType = items[input.item]?.type;
						const inputHasRecipe = getRecipesForItem(input.item).length > 0;
						const inputRate = (input.rate ?? 0) * buildingCount;
						const childId = input.item + '_' + (depth + 1);
						if (!nodeMap[childId]) {
							const inputItemObj = items[input.item];
							if (!inputItemObj) {
								console.log(`Unknown item in graph: ${input.item}`);
								nodeMap[childId] = { id: childId, label: `Unknown: ${input.item}\n${inputRate ? inputRate.toFixed(2) : ''}`, shape: 'ellipse', color: '#f55', font: { color: '#23272b', size: 16 }, rate: inputRate, count: 1, parents: new Set() };
								nodes.push(nodeMap[childId]);
							} else {
								let nodeObj;
								let showRate = inputItemObj.type !== 'nonsolid';
								if (inputItemObj.icon) {
									nodeObj = {
										id: childId,
										label: showRate ? `${inputItemObj.name}\n${inputRate ? inputRate.toFixed(2) : ''}${depth === 0 ? ' /min' : ''}` : `${inputItemObj.name}`,
										shape: 'image',
										image: inputItemObj.icon,
										color: inputType === 'nonsolid' ? '#4fc3f7' : '#fff',
										font: { color: '#fff', size: 16, multi: true },
										rate: inputRate, count: 1, parents: new Set()
									};
								} else {
									nodeObj = {
										id: childId,
										label: showRate ? `${inputItemObj.name}\n${inputRate ? inputRate.toFixed(2) : ''}${depth === 0 ? ' /min' : ''}` : `${inputItemObj.name}`,
										shape: 'ellipse',
										color: inputType === 'nonsolid' ? '#4fc3f7' : '#fff',
										font: { color: '#23272b', size: 16, multi: true },
										rate: inputRate, count: 1, parents: new Set()
									};
								}
								nodeMap[childId] = nodeObj;
								nodes.push(nodeObj);
							}
						} else {
							nodeMap[childId].rate += inputRate;
							nodeMap[childId].count += 1;
							// Update label to show combined rate, but hide for nonsolid
							let labelName = nodeMap[childId].label.split('\n')[0];
							let showRate = items[input.item]?.type !== 'nonsolid';
							nodeMap[childId].label = showRate ? `${labelName}\n${nodeMap[childId].rate.toFixed(2)}${depth === 0 ? ' /min' : ''}` : `${labelName}`;
						}
						// Label edges with building used; combine labels if multiple
						const buildingName = buildings[recipe.building]?.name || recipe.building;
						const edgeKey = childId + '->' + nodeId;
						if (!edgeLabels[edgeKey]) edgeLabels[edgeKey] = new Set();
						edgeLabels[edgeKey].add(buildingName);
						// Only add unique edges; otherwise update the label
						if (!nodeMap[childId].parents.has(nodeId)) {
							const labelText = Array.from(edgeLabels[edgeKey]).join(', ');
							edges.push({ from: childId, to: nodeId, arrows: 'to', color: '#aaa', width: 1.5, label: labelText, font: { color: '#ffb347', size: 12, strokeWidth: 0 } });
							edgeIndex[edgeKey] = edges.length - 1;
							nodeMap[childId].parents.add(nodeId);
						} else {
							const idx = edgeIndex[edgeKey];
							if (typeof idx === 'number' && edges[idx]) {
								edges[idx].label = Array.from(edgeLabels[edgeKey]).join(', ');
							}
						}
						if (inputType === 'nonsolid') {
							if (!producedNonsolids[input.item]) {
								producedNonsolids[input.item] = true;
								if (inputHasRecipe) {
									buildGraphData(input.item, inputRate, nodes, edges, childId, nodeMap, depth + 1, producedNonsolids, edgeLabels, edgeIndex);
								}
							}
						} else if (inputHasRecipe) {
							buildGraphData(input.item, inputRate, nodes, edges, childId, nodeMap, depth + 1, producedNonsolids, edgeLabels, edgeIndex);
						}
					});
				});
				return { nodes, edges };
			}

			// Render the network graph
			const graphDiv = document.getElementById('network-graph');
			if (graphDiv) {
				graphDiv.innerHTML = '';
				const data = buildGraphData(selectedItem, rate, [], [], null, {}, 0, {}, {}, {});
				if (data && data.nodes.length > 0) {
					// Remove .parents property from nodes for vis-network
					data.nodes.forEach(n => { if (n.parents) delete n.parents; });
					const network = new vis.Network(graphDiv, data, {
						nodes: {
							borderWidth: 2,
							shadow: true,
							shape: 'box',
							color: { background: '#ffb347', border: '#23272b', highlight: { background: '#ffd580', border: '#23272b' } },
							font: { color: '#23272b', size: 18, face: 'Roboto' },
							margin: 12
						},
						edges: {
							color: { color: '#aaa', highlight: '#ffb347', hover: '#ffb347' },
							arrows: 'to',
							smooth: { type: 'cubicBezier', forceDirection: 'vertical', roundness: 0.3 },
							width: 1.5
						},
						layout: {
							hierarchical: {
								direction: 'UD',
								sortMethod: 'directed',
								nodeSpacing: 220,
								levelSeparation: 140,
								treeSpacing: 320,
								parentCentralization: true
							}
						},
						physics: false,
						interaction: {
							hover: true,
							tooltipDelay: 100,
							navigationButtons: true,
							keyboard: true
						}
					});

					// Highlight connected nodes on select
					network.on('selectNode', function(params) {
						const selected = params.nodes[0];
						const connectedNodes = network.getConnectedNodes(selected);
						network.selectNodes([selected, ...connectedNodes]);
						// Optionally, highlight edges too
						const connectedEdges = network.getConnectedEdges(selected);
						network.setSelection({ nodes: [selected, ...connectedNodes], edges: connectedEdges });
					});
					network.on('deselectNode', function() {
						network.unselectAll();
					});
				} else {
					graphDiv.innerHTML = '<div style="color:#888;text-align:center;margin-top:2rem;">No graph data available.</div>';
				}
			}
		});
		</script>
	</div>
</body>
</html>
